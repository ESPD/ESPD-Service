<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.3">
<title>European Single Procurement Document (ESPD)</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
/* Remove comment around @import statement below when using as a custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}
audio,canvas,video{display:inline-block}
audio:not([controls]){display:none;height:0}
[hidden],template{display:none}
script{display:none!important}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
body{margin:0}
a{background:transparent}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
input[type="search"]{-webkit-appearance:textfield;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;box-sizing:content-box}
input[type="search"]::-webkit-search-cancel-button,input[type="search"]::-webkit-search-decoration{-webkit-appearance:none}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*:before,*:after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
body{-webkit-font-smoothing:antialiased}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.spread{width:100%}
p.lead,.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{font-size:1.21875em;line-height:1.6}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:none}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #ddddd8;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol,ul.no-bullet,ol.no-bullet{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.no-bullet{list-style:none}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite:before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media only screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7;font-weight:bold}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
body{tab-size:4}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix:before,.clearfix:after,.float-group:before,.float-group:after{content:" ";display:table}
.clearfix:after,.float-group:after{clear:both}
*:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre,pre>code{line-height:1.45;color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;text-rendering:optimizeSpeed}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menu{color:rgba(0,0,0,.8)}
b.button:before,b.button:after{position:relative;top:-1px;font-weight:400}
b.button:before{content:"[";padding:0 3px 0 2px}
b.button:after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header:before,#header:after,#content:before,#content:after,#footnotes:before,#footnotes:after,#footer:before,#footer:after{content:" ";display:table}
#header:after,#content:after,#footnotes:after,#footer:after{clear:both}
#content{margin-top:1.25em}
#content:before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #ddddd8}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #ddddd8;padding-bottom:8px}
#header .details{border-bottom:1px solid #ddddd8;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span:before{content:"\00a0\2013\00a0"}
#header .details br+span.author:before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark:before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber:after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #ddddd8;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #efefed;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media only screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #efefed;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #efefed;left:auto;right:0}}
@media only screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
.sect1{padding-bottom:.625em}
@media only screen and (min-width:768px){.sect1{padding-bottom:1.25em}}
.sect1+.sect1{border-top:1px solid #efefed}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor:before,h2>a.anchor:before,h3>a.anchor:before,#toctitle>a.anchor:before,.sidebarblock>.content>.title>a.anchor:before,h4>a.anchor:before,h5>a.anchor:before,h6>a.anchor:before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock>caption.title{white-space:nowrap;overflow:visible;max-width:0}
.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>.paragraph:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #ddddd8;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock pre:not(.highlight),.listingblock pre[class="highlight"],.listingblock pre[class^="highlight "],.listingblock pre.CodeRay,.listingblock pre.prettyprint{background:#f7f7f8}
.sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}
.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;padding:1em;font-size:.8125em}
.literalblock pre.nowrap,.literalblock pre[class].nowrap,.listingblock pre.nowrap,.listingblock pre[class].nowrap{overflow-x:auto;white-space:pre;word-wrap:normal}
@media only screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}
@media only screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}
.literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.listingblock>.content{position:relative}
.listingblock code[data-lang]:before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}
.listingblock:hover code[data-lang]:before{display:block}
.listingblock.terminal pre .command:before{content:attr(data-prompt);padding-right:.5em;color:#999}
.listingblock.terminal pre .command:not([data-prompt]):before{content:"$"}
table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0;line-height:1.45}
table.pyhltable td.code{padding-left:.75em;padding-right:0}
pre.pygments .lineno,table.pyhltable td:not(.code){color:#999;padding-left:0;padding-right:.5em;border-right:1px solid #ddddd8}
pre.pygments .lineno{display:inline-block;margin-right:.25em}
table.pyhltable .linenodiv{background:none!important;padding-right:0!important}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock blockquote p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote:before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.5em;margin-right:.5ex;text-align:right}
.quoteblock .quoteblock{margin-left:0;margin-right:0;padding:.5em 0;border-left:3px solid rgba(0,0,0,.6)}
.quoteblock .quoteblock blockquote{padding:0 0 0 .75em}
.quoteblock .quoteblock blockquote:before{display:none}
.verseblock{margin:0 1em 1.25em 1em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract{margin:0 0 1.25em 0;display:block}
.quoteblock.abstract blockquote,.quoteblock.abstract blockquote p{text-align:left;word-spacing:0}
.quoteblock.abstract blockquote:before,.quoteblock.abstract blockquote p:first-of-type:before{display:none}
table.tableblock{max-width:100%;border-collapse:separate}
table.tableblock td>.paragraph:last-child p>p:last-child,table.tableblock th>p:last-child,table.tableblock td>p:last-child{margin-bottom:0}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all th.tableblock,table.grid-all td.tableblock{border-width:0 1px 1px 0}
table.grid-all tfoot>tr>th.tableblock,table.grid-all tfoot>tr>td.tableblock{border-width:1px 1px 0 0}
table.grid-cols th.tableblock,table.grid-cols td.tableblock{border-width:0 1px 0 0}
table.grid-all *>tr>.tableblock:last-child,table.grid-cols *>tr>.tableblock:last-child{border-right-width:0}
table.grid-rows th.tableblock,table.grid-rows td.tableblock{border-width:0 0 1px 0}
table.grid-all tbody>tr:last-child>th.tableblock,table.grid-all tbody>tr:last-child>td.tableblock,table.grid-all thead:last-child>tr>th.tableblock,table.grid-rows tbody>tr:last-child>th.tableblock,table.grid-rows tbody>tr:last-child>td.tableblock,table.grid-rows thead:last-child>tr>th.tableblock{border-bottom-width:0}
table.grid-rows tfoot>tr>th.tableblock,table.grid-rows tfoot>tr>td.tableblock{border-width:1px 0 0 0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot{border-width:1px 0}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
td>div.verse{white-space:pre}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.unstyled,ol.unnumbered,ul.checklist,ul.none{list-style-type:none}
ul.unstyled,ol.unnumbered,ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1em;font-size:.85em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{width:1em;position:relative;top:1px}
ul.inline{margin:0 auto .625em auto;margin-left:-1.375em;margin-right:0;padding:0;list-style:none;overflow:hidden}
ul.inline>li{list-style:none;float:left;margin-left:1.375em;display:block}
ul.inline>li>*{display:block}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist>table tr>td:first-of-type{padding:0 .75em;line-height:1}
.colist>table tr>td:last-of-type{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left,.imageblock[style*="float: left"]{margin:.25em .625em 1.25em 0}
.imageblock.right,.imageblock[style*="float: right"]{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em 0;border-width:1px 0 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;text-indent:-1.05em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background-color:#00fafa}
.black{color:#000}
.black-background{background-color:#000}
.blue{color:#0000bf}
.blue-background{background-color:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background-color:#fa00fa}
.gray{color:#606060}
.gray-background{background-color:#7d7d7d}
.green{color:#006000}
.green-background{background-color:#007d00}
.lime{color:#00bf00}
.lime-background{background-color:#00fa00}
.maroon{color:#600000}
.maroon-background{background-color:#7d0000}
.navy{color:#000060}
.navy-background{background-color:#00007d}
.olive{color:#606000}
.olive-background{background-color:#7d7d00}
.purple{color:#600060}
.purple-background{background-color:#7d007d}
.red{color:#bf0000}
.red-background{background-color:#fa0000}
.silver{color:#909090}
.silver-background{background-color:#bcbcbc}
.teal{color:#006060}
.teal-background{background-color:#007d7d}
.white{color:#bfbfbf}
.white-background{background-color:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background-color:#fafa00}
span.icon>.fa{cursor:default}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note:before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip:before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning:before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution:before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important:before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]:after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@media print{@page{margin:1.25cm .75cm}
*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare):after,a[href^="https:"]:not(.bare):after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]:after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #ddddd8!important;padding-bottom:0!important}
.sect1{padding-bottom:0!important}
.sect1+.sect1{border:0!important}
#header>h1:first-child{margin-top:1.25rem}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em 0}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span:before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]:before{display:block}
#footer{background:none!important;padding:0 .9375em}
#footer-text{color:rgba(0,0,0,.6)!important;font-size:.9em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.4.0/css/font-awesome.min.css">
<style>
/* Stylesheet for CodeRay to match GitHub theme | MIT License | http://foundation.zurb.com */
/*pre.CodeRay {background-color:#f7f7f8;}*/
.CodeRay .line-numbers{border-right:1px solid #d8d8d8;padding:0 0.5em 0 .25em}
.CodeRay span.line-numbers{display:inline-block;margin-right:.5em;color:rgba(0,0,0,.3)}
.CodeRay .line-numbers strong{color:rgba(0,0,0,.4)}
table.CodeRay{border-collapse:separate;border-spacing:0;margin-bottom:0;border:0;background:none}
table.CodeRay td{vertical-align: top;line-height:1.45}
table.CodeRay td.line-numbers{text-align:right}
table.CodeRay td.line-numbers>pre{padding:0;color:rgba(0,0,0,.3)}
table.CodeRay td.code{padding:0 0 0 .5em}
table.CodeRay td.code>pre{padding:0}
.CodeRay .debug{color:#fff !important;background:#000080 !important}
.CodeRay .annotation{color:#007}
.CodeRay .attribute-name{color:#000080}
.CodeRay .attribute-value{color:#700}
.CodeRay .binary{color:#509}
.CodeRay .comment{color:#998;font-style:italic}
.CodeRay .char{color:#04d}
.CodeRay .char .content{color:#04d}
.CodeRay .char .delimiter{color:#039}
.CodeRay .class{color:#458;font-weight:bold}
.CodeRay .complex{color:#a08}
.CodeRay .constant,.CodeRay .predefined-constant{color:#008080}
.CodeRay .color{color:#099}
.CodeRay .class-variable{color:#369}
.CodeRay .decorator{color:#b0b}
.CodeRay .definition{color:#099}
.CodeRay .delimiter{color:#000}
.CodeRay .doc{color:#970}
.CodeRay .doctype{color:#34b}
.CodeRay .doc-string{color:#d42}
.CodeRay .escape{color:#666}
.CodeRay .entity{color:#800}
.CodeRay .error{color:#808}
.CodeRay .exception{color:inherit}
.CodeRay .filename{color:#099}
.CodeRay .function{color:#900;font-weight:bold}
.CodeRay .global-variable{color:#008080}
.CodeRay .hex{color:#058}
.CodeRay .integer,.CodeRay .float{color:#099}
.CodeRay .include{color:#555}
.CodeRay .inline{color:#000}
.CodeRay .inline .inline{background:#ccc}
.CodeRay .inline .inline .inline{background:#bbb}
.CodeRay .inline .inline-delimiter{color:#d14}
.CodeRay .inline-delimiter{color:#d14}
.CodeRay .important{color:#555;font-weight:bold}
.CodeRay .interpreted{color:#b2b}
.CodeRay .instance-variable{color:#008080}
.CodeRay .label{color:#970}
.CodeRay .local-variable{color:#963}
.CodeRay .octal{color:#40e}
.CodeRay .predefined{color:#369}
.CodeRay .preprocessor{color:#579}
.CodeRay .pseudo-class{color:#555}
.CodeRay .directive{font-weight:bold}
.CodeRay .type{font-weight:bold}
.CodeRay .predefined-type{color:inherit}
.CodeRay .reserved,.CodeRay .keyword {color:#000;font-weight:bold}
.CodeRay .key{color:#808}
.CodeRay .key .delimiter{color:#606}
.CodeRay .key .char{color:#80f}
.CodeRay .value{color:#088}
.CodeRay .regexp .delimiter{color:#808}
.CodeRay .regexp .content{color:#808}
.CodeRay .regexp .modifier{color:#808}
.CodeRay .regexp .char{color:#d14}
.CodeRay .regexp .function{color:#404;font-weight:bold}
.CodeRay .string{color:#d20}
.CodeRay .string .string .string{background:#ffd0d0}
.CodeRay .string .content{color:#d14}
.CodeRay .string .char{color:#d14}
.CodeRay .string .delimiter{color:#d14}
.CodeRay .shell{color:#d14}
.CodeRay .shell .delimiter{color:#d14}
.CodeRay .symbol{color:#990073}
.CodeRay .symbol .content{color:#a60}
.CodeRay .symbol .delimiter{color:#630}
.CodeRay .tag{color:#008080}
.CodeRay .tag-special{color:#d70}
.CodeRay .variable{color:#036}
.CodeRay .insert{background:#afa}
.CodeRay .delete{background:#faa}
.CodeRay .change{color:#aaf;background:#007}
.CodeRay .head{color:#f8f;background:#505}
.CodeRay .insert .insert{color:#080}
.CodeRay .delete .delete{color:#800}
.CodeRay .change .change{color:#66f}
.CodeRay .head .head{color:#f4f}
</style>
<!--
  ~
  ~ Copyright 2016 EUROPEAN COMMISSION
  ~
  ~ Licensed under the EUPL, Version 1.1 or â€“ as soon they
  ~ will be approved by the European Commission - subsequent
  ~ versions of the EUPL (the "Licence");
  ~
  ~ You may not use this work except in compliance with the Licence.
  ~
  ~ You may obtain a copy of the Licence at:
  ~
  ~ https://joinup.ec.europa.eu/community/eupl/og_page/eupl
  ~
  ~ Unless required by applicable law or agreed to in
  ~ writing, software distributed under the Licence is
  ~ distributed on an "AS IS" basis,
  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either
  ~ express or implied.
  ~ See the Licence for the specific language governing
  ~ permissions and limitations under the Licence.
  ~
  -->

<!-- This file allows us to customize the stylesheets -->

<!-- style -->
<link href="themes/espd/espd.css" rel="stylesheet" type="text/css" />
</head>
<body class="article toc2 toc-left">
<div id="header">
<h1>European Single Procurement Document (ESPD)</h1>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#about">About</a></li>
<li><a href="#system-requirements">System requirements</a></li>
<li><a href="#installation">Installation</a>
<ul class="sectlevel2">
<li><a href="#configure-the-git-repository">Configure the Git repository</a></li>
<li><a href="#running-and-deploying-the-espd-application">Running and deploying the ESPD application</a></li>
</ul>
</li>
<li><a href="#overview">Overview</a>
<ul class="sectlevel2">
<li><a href="#java-packages-overview">Java packages overview</a></li>
<li><a href="#web-overview">Web overview</a></li>
</ul>
</li>
<li><a href="#configuration">Configuration</a>
<ul class="sectlevel2">
<li><a href="#configuration-files">Configuration files</a></li>
<li><a href="#spring">Spring</a></li>
<li><a href="#spring-mvc">Spring MVC</a></li>
<li><a href="#internationalization-i18n">Internationalization (i18n)</a></li>
<li><a href="#web-resources-optimization">Web Resources Optimization</a></li>
<li><a href="#lombok">Lombok</a></li>
<li><a href="#logging">Logging</a></li>
<li><a href="#monitoring-and-analytics">Monitoring and analytics</a></li>
<li><a href="#criteria-definitions">Criteria definitions</a></li>
<li><a href="#jaxb">JAXB</a></li>
<li><a href="#rest-template">REST template</a></li>
<li><a href="#ted-rest-service">TED REST service</a></li>
</ul>
</li>
<li><a href="#view">View</a>
<ul class="sectlevel2">
<li><a href="#forms">Forms</a></li>
<li><a href="#internationalization-i18n-2">Internationalization (i18n)</a></li>
<li><a href="#dynamic-web-page-translation">Dynamic web page translation</a></li>
</ul>
</li>
<li><a href="#testing">Testing</a>
<ul class="sectlevel2">
<li><a href="#anatomy-of-a-test-specification">Anatomy of a test specification</a></li>
<li><a href="#testing-the-generation-of-an-xml-file">Testing the generation of an XML file</a></li>
<li><a href="#testing-the-parsing-of-an-xml-file">Testing the parsing of an XML file</a></li>
</ul>
</li>
<li><a href="#data-model">Data model</a>
<ul class="sectlevel2">
<li><a href="#the-espd-request-xml-document-overview">The ESPD Request XML document overview</a></li>
<li><a href="#java-packages">Java packages</a></li>
</ul>
</li>
<li><a href="#release-notes">Release notes</a>
<ul class="sectlevel2">
<li><a href="#2016-06-01-30th-of-june-2016">2016.06.01 (30th of June 2016)</a></li>
<li><a href="#2016-06-2nd-of-june-2016">2016.06 (2nd of June 2016)</a></li>
<li><a href="#2016-05-12th-of-may-2016">2016.05 (12th of May 2016)</a></li>
<li><a href="#2016-04-02-2nd-of-may-2016">2016.04.02 (2nd of May 2016)</a></li>
<li><a href="#2016-04-01-25th-of-april-2016">2016.04.01 (25th of April 2016)</a></li>
<li><a href="#2016-04-15th-of-april-2016">2016.04 (15th of April 2016)</a></li>
<li><a href="#1-1-10th-of-february-2016">1.1 (10th of February 2016)</a></li>
<li><a href="#1-0-6th-of-november-2015">1.0 (6th of November 2015)</a></li>
</ul>
</li>
<li><a href="#license">License</a></li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Alexey Lukashov<br>
Virgiliu Ratoi</p>
</div>
<div class="paragraph">
<p>v2016.06.01, 30-06-2016</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="about"><a class="anchor" href="#about"></a>About</h2>
<div class="sectionbody">
<div class="imageblock">
<div class="content">
<img src="https://img.shields.io/badge/Java%20Development%20Kit-7%2B-blue.svg?style=flat" alt="JDK">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="https://img.shields.io/badge/Spring%20Boot-1.3.3-green.svg?style=flat" alt="Spring Boot">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="https://img.shields.io/badge/Maven-3.0%2B-blue.svg?style=flat" alt="Maven">
</div>
</div>
<div class="paragraph">
<p>The <a href="https://ec.europa.eu/growth/tools-databases/espd/">ESPD</a> service is a web-based solution which allows the <a href="http://europa.eu/about-eu/countries/index_en.htm">Member States</a> and <a href="http://europa.eu/about-eu/institutions-bodies">European Institutions</a> to exchange structured
<a href="https://en.wikipedia.org/wiki/E-procurement">e-procurement</a> information in a harmonised manner. The system is not a persistent storage but rather a transformation
service which enables the management of XML based documents for each procurement submitted.</p>
</div>
<div class="paragraph">
<p>The <a href="https://ec.europa.eu/growth/tools-databases/espd/">ESPD</a> service is provided as a web-based system and the output of it provided as XML files. In addition,
the <a href="https://ec.europa.eu/growth/tools-databases/espd/">ESPD</a> service will become part of the <a href="https://ec.europa.eu/digital-single-market/en/connecting-europe-facility">Connecting European Facility (CEF)</a> <a href="https://ec.europa.eu/cefdigital/wiki/display/CEFDIGITAL/eProcurement">eProcurement DSI (Digital Service
Infrastructure)</a>. The CEF will help the Member States to implement an <a href="https://ec.europa.eu/growth/tools-databases/espd/">ESPD</a> service in their own country and
provide additional services to their users.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="system-requirements"><a class="anchor" href="#system-requirements"></a>System requirements</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <a href="https://ec.europa.eu/growth/tools-databases/espd/">ESPD</a> application requires the following tools to run so please make sure that you have them installed
prior to proceeding with the installation of the project.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="http://www.oracle.com/technetwork/java/javase/downloads/index.html">Java Development Kit 7+</a></p>
</li>
<li>
<p><a href="https://maven.apache.org">Maven 3</a></p>
</li>
<li>
<p><a href="https://git-scm.com/downloads">Git</a></p>
</li>
<li>
<p><a href="https://tomcat.apache.org">Tomcat 7+</a> or other Servlet 3+ container (optional)</p>
</li>
<li>
<p>No database is necessary</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="installation"><a class="anchor" href="#installation"></a>Installation</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="configure-the-git-repository"><a class="anchor" href="#configure-the-git-repository"></a>Configure the Git repository</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Fork the <a href="https://github.com/ESPD/espd.git">ESPD Git repository</a> by clicking on the <code>Fork</code> button on the top-right corner of the repository page. Forking a
repository allows you to freely experiment with changes without affecting the original project. Most commonly, forks
are used to either propose changes to someone else&#8217;s project or to use someone else&#8217;s project as a starting point for
your own idea.</p>
</li>
<li>
<p>Create a local clone of your fork</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>On GitHub, navigate to your fork of the <a href="https://github.com/ESPD/espd.git">ESPD Git repository</a>.</p>
</li>
<li>
<p>Under your repository name, click the <code>Copy to clipboard</code> button to clone the URL for the repository.</p>
</li>
<li>
<p>Run the <code>git clone <a href="https://github.com/YOUR-USERNAME/espd" class="bare">https://github.com/YOUR-USERNAME/espd</a></code> command on your computer. Now, you have a local copy of
your fork of the <a href="https://github.com/ESPD/espd.git">ESPD Git repository</a>.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Configure Git to sync your fork with the original <a href="https://github.com/ESPD/espd.git">ESPD Git repository</a>. When you fork a project in order to propose
changes to the original repository, you can configure Git to pull changes from the original, or <em>upstream</em>, repository
into the local clone of your fork.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>On GitHub, navigate to the <a href="https://github.com/ESPD/espd.git">ESPD Git repository</a> repository.</p>
</li>
<li>
<p>Under your repository name, click the <code>Copy to clipboard</code> button to clone the URL for the repository.</p>
</li>
<li>
<p>Change directories to the location of the fork you cloned in the previous step.</p>
</li>
<li>
<p>Execute <code>git remote -v</code> to see the current configured remote repository for your fork.</p>
</li>
<li>
<p>Type <code>git remote add upstream <a href="https://github.com/ESPD/espd.git" class="bare">https://github.com/ESPD/espd.git</a></code> by pasting the URL you copied in Step 2.</p>
</li>
<li>
<p>To verify the new upstream repository you&#8217;ve specified for your fork, type <code>git remote -v</code> again. You should see
the URL for your fork as <code>origin</code>, and the URL for the original repository as <code>upstream</code>.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">$ git remote -v
origin    https://github.com/YOUR_USERNAME/YOUR_FORK.git (fetch)
origin    https://github.com/YOUR_USERNAME/YOUR_FORK.git (push)
upstream  https://github.com/ORIGINAL_OWNER/ORIGINAL_REPOSITORY.git (fetch)
upstream  https://github.com/ORIGINAL_OWNER/ORIGINAL_REPOSITORY.git (push)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now, you can keep your fork synced with the <code>upstream</code> repository with a few Git commands. For more information,
please see the <a href="https://help.github.com/articles/syncing-a-fork/">Syncing a fork</a> page.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Quite often people working in a team and using the same repository or upstream prefer different operating systems.
This may result in problems with line endings because Unix, Linux, and OS X use LF and Windows uses CRLF to denote
the end of a line. To have Git solve such problems automatically, you need to set the <code>core.autocrlf</code> attribute to
<code>true</code> on Windows and to <code>input</code> on Linux and OS X. For more details on the meaning of the <code>core.autocrlf</code> attribute,
see the article <a href="https://help.github.com/articles/dealing-with-line-endings">Dealing with Line Endings</a>. You can change the configuration manually by running
<code>git config --global core.autocrlf true</code> on Windows or <code>git config --global core.autocrlf input</code> on Linux and OS X.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Each major application version will have a dedicated branch so you can checkout the code for a particular version.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="running-and-deploying-the-espd-application"><a class="anchor" href="#running-and-deploying-the-espd-application"></a>Running and deploying the ESPD application</h3>
<div class="paragraph">
<p>This section goes into detail about how you can build and run the <a href="https://ec.europa.eu/growth/tools-databases/espd/">ESPD</a> application.</p>
</div>
<div class="sect3">
<h4 id="building-the-application"><a class="anchor" href="#building-the-application"></a>Building the application</h4>
<div class="paragraph">
<p>The <a href="https://ec.europa.eu/growth/tools-databases/espd/">ESPD</a> uses <a href="https://maven.apache.org">Maven 3</a> as the primary build system and is structured as a multi-module Maven project.</p>
</div>
<div class="paragraph">
<p>After getting access to the source code and copying it on your computer, you can now build the project with <a href="https://maven.apache.org">Maven 3</a>.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Change directories to the location of the cloned Git repository on your machine.</p>
</li>
<li>
<p>Perform a <code>mvn clean package</code> and now the project dependencies should be downloaded and the <code>exchange-model</code>,
<code>espd-web</code> and <code>espd-docs</code> modules should be built.</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="running-from-an-ide"><a class="anchor" href="#running-from-an-ide"></a>Running from an IDE</h4>
<div class="paragraph">
<p>You can run the <a href="https://ec.europa.eu/growth/tools-databases/espd/">ESPD</a> application from your IDE by importing the project as a multi-module Maven project first.
You also need to install the Lombok plugin for your particular IDE.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Before running the application you need to generate the <a href="https://jaxb.java.net">JAXB</a> classes by invoking a <code>mvn clean package</code> command
and then add the <code>src/main/generated</code> folder on the application classpath of the <code>exchange-model</code> Maven module.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="run-with-an-embedded-tomcat-container"><a class="anchor" href="#run-with-an-embedded-tomcat-container"></a>Run with an embedded Tomcat container</h4>
<div class="paragraph">
<p>The easiest way to start the application is with an embedded Tomcat 8 (default) container by invoking the <code>main</code> method
from the <code>eu.europa.ec.grow.espd.config.EspdApplication</code> class in the same way as you would start a normal Java non-web
application.</p>
</div>
</div>
<div class="sect3">
<h4 id="run-as-an-exploded-war-file-on-a-servlet-container"><a class="anchor" href="#run-as-an-exploded-war-file-on-a-servlet-container"></a>Run as an exploded WAR file on a Servlet container</h4>
<div class="paragraph">
<p>The application can be deployed as an exploded WAR file on different Servlet 3 containers. For example, you can
check the following links on how to deploy it on a Tomcat container:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://www.jetbrains.com/help/idea/2016.1/configuring-web-application-deployment.html?origin=old_help">IntelliJ IDEA</a></p>
</li>
<li>
<p><a href="https://www.mulesoft.com/tcat/tomcat-eclipse">Eclipse Tomcat</a></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="deploying-with-the-embedded-tomcat-container"><a class="anchor" href="#deploying-with-the-embedded-tomcat-container"></a>Deploying with the embedded Tomcat container</h4>
<div class="paragraph">
<p>The fastest way to deploy the application is by using an embedded Tomcat container.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Perform a <code>mvn clean package</code> from the root folder of the project:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>The build should generate a WAR file at <code>${baseDir}/espd-web/target/espd-web.war</code></p>
</li>
</ol>
</div>
</li>
<li>
<p>Add the following startup parameters to you server:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p><code>-Dspring.profiles.active=${your desired profile}</code> specifies the <a href="http://docs.spring.io/spring-boot/docs/current/reference/htmlsingle/#boot-features-external-config-profile-specific-properties">Spring Boot profile</a> to be used</p>
</li>
<li>
<p><code>-Dted.api.user=${your TED user}</code> where <code>${your TED user}</code> is replaced by the TED API username</p>
</li>
<li>
<p><code>-Dted.api.password=${your TED password}</code> where <code>${your TED password}</code> must be replaced by the TED API password</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>The application can be started with a shell script that can contain the following minimum configuration:</p>
</div>
<div class="listingblock">
<div class="title">start.sh</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">java -Dspring.profiles.active=prod -Xms768m -Xmx768m -jar espd-web.war</code></pre>
</div>
</div>
<div class="paragraph">
<p>Other application parameters can also be specified in exactly the same way, i.e. by prefixing them with a <code>-D</code> followed
by the name of the parameter. You can consult the <code>application.properties</code> files for finding out the available options
but please note that the ones specified at start-up have higher precedence than the ones specified in the <code>.properties</code>
files.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
It is recommended to set up the context path of the application when running in the embedded mode.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">application.properties</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="properties"># Context path of the application
server.context-path=/espd</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="deploying-on-an-external-servlet-container"><a class="anchor" href="#deploying-on-an-external-servlet-container"></a>Deploying on an external Servlet container</h4>
<div class="paragraph">
<p>If you want to deploy the application on an external Servlet container, you need to package it as a WAR for the
<code>non-embedded</code> Maven profile and provide some startup parameters on your server.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Perform a <code>mvn clean package -Pnon-embedded</code> from the root folder of the project:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>The build should generate a WAR file at <code>${baseDir}/espd-web/target/espd-web.war</code></p>
</li>
</ol>
</div>
</li>
<li>
<p>The other steps are similar to the embedded server deployment mode</p>
</li>
</ol>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="overview"><a class="anchor" href="#overview"></a>Overview</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <a href="https://ec.europa.eu/growth/tools-databases/espd/">ESPD</a> application is composed of three <a href="https://maven.apache.org">Maven 3</a> modules:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>espd-docs</strong> contains the documentation of the application</p>
</li>
<li>
<p><strong>espd-web</strong> holds the deployable web part of the application</p>
</li>
<li>
<p><strong>exchange-model</strong> is where the XML schemas and JAXB bindings are defined</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The ESPD web application is quite simple in nature and can be deployed as an executable WAR file (coming soon) or as
a normal WAR file on a Servlet 3 container like Tomcat or Jetty or an application server like Weblogic.</p>
</div>
<div class="paragraph">
<p>The main responsibilities of the application are handled as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Infrastructural support at the application level and dependency injection via the <a href="https://projects.spring.io/spring-framework/">Spring</a> framework</p>
</li>
<li>
<p>Configuration of the application via <a href="http://projects.spring.io/spring-boot/">Spring Boot</a></p>
</li>
<li>
<p>Logging with the <a href="http://www.slf4j.org/">SLF4J</a> API and <a href="http://logback.qos.ch/">Logback</a> as implementation</p>
</li>
<li>
<p>The view part uses <a href="http://docs.spring.io/autorepo/docs/spring/3.2.x/spring-framework-reference/html/mvc.html">Spring MVC</a>, JSP files, <a href="https://tiles.apache.org/">Apache Tiles</a>, Javascript, <a href="https://jquery.com/">jQuery</a> and <a href="http://getbootstrap.com/">Twitter Bootstrap</a></p>
</li>
<li>
<p>The XML model uses <a href="https://jaxb.java.net">JAXB</a> to marshal/unmarshal the ESPD generated XML files</p>
</li>
<li>
<p>REST calls to external services are handled with the <a href="https://spring.io/guides/gs/consuming-rest/">Spring Rest Template</a> client</p>
</li>
<li>
<p>Monitoring and analytics via <a href="https://github.com/javamelody/javamelody/wiki">Java Melody</a> and <a href="http://piwik.org/">Piwik</a></p>
</li>
<li>
<p>Optimization of static resources with <a href="https://spring.io/blog/2014/07/24/spring-framework-4-1-handling-static-web-resources">Spring asset pipeline</a> and <a href="https://github.com/wro4j/wro4j">WRO4J</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="java-packages-overview"><a class="anchor" href="#java-packages-overview"></a>Java packages overview</h3>
<div class="paragraph">
<p>The main Java package of the web application is 'eu.europa.ec.grow.espd` found in the <code>espd-web</code> module. It is further
subdivided into the following important packages:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>config</p>
</li>
<li>
<p>controller</p>
</li>
<li>
<p>domain</p>
</li>
<li>
<p>ted</p>
</li>
<li>
<p>util</p>
</li>
<li>
<p>xml</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="config-package"><a class="anchor" href="#config-package"></a>Config package</h4>
<div class="paragraph">
<p>The <code>config</code> package contains the Java classes which are supposed to provide the configuration for the global project
<code>EspdApplication</code>, <a href="http://docs.spring.io/autorepo/docs/spring/3.2.x/spring-framework-reference/html/mvc.html">Spring MVC</a> web configuration <code>WebConfiguration</code>, the <a href="https://jaxb.java.net">JAXB</a> configuration etc. You will
notice that these classes are annotated with <code>@Configuration</code> and they generally define <a href="https://projects.spring.io/spring-framework/">Spring</a> beans that can be
injected in other <a href="https://projects.spring.io/spring-framework/">Spring</a> managed classes of the application.</p>
</div>
</div>
<div class="sect3">
<h4 id="controller-package"><a class="anchor" href="#controller-package"></a>Controller package</h4>
<div class="paragraph">
<p>The <code>controller</code> package consists of the <a href="http://docs.spring.io/autorepo/docs/spring/3.2.x/spring-framework-reference/html/mvc.html">Spring MVC</a> controllers which are responsible for processing user requests,
building an appropriate model and passing it to the view for rendering or which can act as <a href="https://en.wikipedia.org/wiki/Representational_state_transfer">REST</a> controllers.</p>
</div>
<div class="paragraph">
<p>The most important one is <code>EspdController</code> and its responsibilities include dealing with the generation of the <a href="https://ec.europa.eu/growth/tools-databases/espd/">ESPD</a>
requests and responses, uploading files, printing and error handling. The main flow of the application is handled by
this class.</p>
</div>
<div class="paragraph">
<p>Other controllers which are present in this package are the <code>AboutController</code> that is used to populate the <code>/about</code>
page of the application and <code>MessageSourceController</code> which is responsible for loading the i18n messages needed
by the client-side i18n engine.</p>
</div>
</div>
<div class="sect3">
<h4 id="domain-package"><a class="anchor" href="#domain-package"></a>Domain package</h4>
<div class="paragraph">
<p>The <code>domain</code> package contains the pieces involved in the representation of an ESPD request or response in the model
(the <code>M</code> part of the MVC architectural pattern) of the web application. An ESPD request/response is represented
internally as an <code>EspdDocument</code> which in turn contains fields for all the possible criteria, authority and economic
operator information or procurement procedure data.</p>
</div>
<div class="paragraph">
<p>In the <code>domain.enums</code> sub-package you can find the enumerations holding the criteria, requirement groups, requirements,
countries, languages, currencies etc which are used by the application. The criteria definitions load metadata coming
from some JSON configuration files under <code>src/main/resources/criteria</code> and store the information dynamically in the
criterion enumerations.</p>
</div>
</div>
<div class="sect3">
<h4 id="ted-package"><a class="anchor" href="#ted-package"></a>TED package</h4>
<div class="paragraph">
<p>The <code>ted</code> package is responsible for the interaction with the TED <a href="https://en.wikipedia.org/wiki/Representational_state_transfer">REST</a> service which provides the procurement
procedure information for an <a href="https://ec.europa.eu/growth/tools-databases/espd/">ESPD</a> request or response.</p>
</div>
</div>
<div class="sect3">
<h4 id="util-package"><a class="anchor" href="#util-package"></a>Util package</h4>
<div class="paragraph">
<p>The <code>util</code> package contains various utility classes, for example, some of the application properties that are needed
by the user interface are loaded by <a href="https://projects.spring.io/spring-framework/">Spring</a> in the <code>EspdConfiguration</code> class. The <code>I18NFunc</code> class loads the i18n
messages needed by the client-side internationalization engine.</p>
</div>
</div>
<div class="sect3">
<h4 id="xml-package"><a class="anchor" href="#xml-package"></a>XML package</h4>
<div class="paragraph">
<p>The <code>xml</code> package takes care of the marshalling/unmarshalling of the ESPD request and response XML files. It is further
divided into a package for <code>request</code>, one for <code>response</code> and a <code>common</code> package with shared functionality between the
other two. The classes from this package make use of the <a href="https://en.wikipedia.org/wiki/Template_method_pattern">Template method design pattern</a> to share common
behaviour and design.</p>
</div>
<div class="paragraph">
<p>The <code>request</code> and <code>response</code> packages contain each an <code>exporting</code> and an <code>importing</code> sub-package. The <code>exporting</code> package
is responsible for generating the ESPD request/response XML files while the <code>importing</code> package knows how to parse XML
files representing ESPD request or response and convert them into the internal ESPD domain objects.</p>
</div>
<div class="paragraph">
<p>The <code>EspdExchangeMarshaller</code> is the main class that aggregates all of the classes from this package together and is
injected in the <code>EspdController</code> to perform the marshalling/unmarshalling logic.</p>
</div>
<div class="paragraph">
<p><code>CriteriaTemplates</code> serves as configuration for the user interface components of the criteria and requirements that
are defined in the JSP and <a href="https://tiles.apache.org/">Apache Tiles</a> files.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="web-overview"><a class="anchor" href="#web-overview"></a>Web overview</h3>
<div class="paragraph">
<p>The web packages can be found in the standard Maven location, i.e. <code>src/main/webapp</code>. The <code>static</code> folder contains the
CSS and Javascript files referenced by the web application. The JSP files are located in the <code>WEB-INF/views</code> folder where
they are subsequently grouped in sub-folders. The <code>src/main/resources</code> folder contains the configuration files relating
to internationalization, logging, web resource optimizations and general application properties.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="configuration"><a class="anchor" href="#configuration"></a>Configuration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section will describe the basic configuration for the most important responsibilities of the application.</p>
</div>
<div class="sect2">
<h3 id="configuration-files"><a class="anchor" href="#configuration-files"></a>Configuration files</h3>
<div class="paragraph">
<p>Most of the configuration properties of the web application are specified in <code>properties</code> files which can be found
inside the <code>src/main/resources</code> folder of the <code>espd-web</code> <a href="https://maven.apache.org">Maven 3</a> module. There are different files for each profile
under which the application can be started, for example the <code>application-prod.properties</code> file will be used for the
<code>prod</code> profile which must be specified as a startup parameter as <code>-Dspring.profiles.active=prod</code>. If no profile is
specified, then a <code>default</code> one will be used by <a href="http://projects.spring.io/spring-boot/">Spring Boot</a> and the corresponding configuration file would be just
<code>application.properties</code>. Here you can find <a href="https://docs.spring.io/spring-boot/docs/current/reference/html/howto-properties-and-configuration.html">more information about properties and configuration with Spring Boot</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="spring"><a class="anchor" href="#spring"></a>Spring</h3>
<div class="paragraph">
<p>The <a href="https://ec.europa.eu/growth/tools-databases/espd/">ESPD</a> application is built from the ground-up with <a href="http://projects.spring.io/spring-boot/">Spring Boot</a>, allowing us to simplify the project configuration
and the management of third party libraries.</p>
</div>
<div class="paragraph">
<p>It does so by specifying in the main <code>pom.xml</code> of the project a parent POM pointing to the <a href="http://projects.spring.io/spring-boot/">Spring Boot</a> starter.</p>
</div>
<div class="listingblock">
<div class="title">pom.xml</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;parent&gt;</span>
  <span class="tag">&lt;groupId&gt;</span>org.springframework.boot<span class="tag">&lt;/groupId&gt;</span>
  <span class="tag">&lt;artifactId&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/artifactId&gt;</span>
  <span class="tag">&lt;version&gt;</span>1.3.2.RELEASE<span class="tag">&lt;/version&gt;</span>
<span class="tag">&lt;/parent&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Since the application is using <a href="http://projects.spring.io/spring-boot/">Spring Boot</a> extensively by inheriting from <code>spring-boot-starter-parent</code>, this provides it
with the following features:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Default Java compiler level</p>
</li>
<li>
<p>UTF-8 source encoding</p>
</li>
<li>
<p>A Dependency Management section, allowing you to omit <code>&lt;version&gt;</code> tags for common dependencies, inherited from the
<code>spring-boot-dependencies</code> POM.</p>
</li>
<li>
<p>Sensible resource filtering, including <code>application.properties</code> and <code>application.yml</code> type of files</p>
</li>
<li>
<p>Sensible plugin configuration</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For more information about the <a href="http://projects.spring.io/spring-boot/">Spring Boot</a> project, you can check the <a href="http://docs.spring.io/spring-boot/docs/current/reference/htmlsingle">official documentation</a>.</p>
</div>
<div class="paragraph">
<p>The <code>eu.europa.ec.grow.espd.config</code> package contains the <a href="https://projects.spring.io/spring-framework/">Spring</a> configuration files. The main class of the application
is <code>EspdApplication</code> which makes use of the <code>@SpringBootApplication</code> annotation in order to enable the <a href="http://projects.spring.io/spring-boot/">Spring Boot</a>
auto configuration. The package also contains the web, <a href="https://jaxb.java.net">JAXB</a> and web resources configuration files.</p>
</div>
</div>
<div class="sect2">
<h3 id="spring-mvc"><a class="anchor" href="#spring-mvc"></a>Spring MVC</h3>
<div class="paragraph">
<p>The web configuration part is found in the <code>WebConfiguration</code> class in conjunction with the following <a href="http://projects.spring.io/spring-boot/">Spring Boot</a> properties:</p>
</div>
<div class="listingblock">
<div class="title">application-dev.properties</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="properties">spring.mvc.view.prefix=/WEB-INF/views/
spring.mvc.view.suffix=.jsp

# Default locale to use
spring.mvc.locale=en</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>WebConfiguration</code> contains the definition of various Spring beans: view resolvers, tiles configuration, locale
interceptors, monitoring filter.</p>
</div>
<div class="listingblock">
<div class="title">WebConfiguration.java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Bean</span>
UrlBasedViewResolver viewResolver() {
  UrlBasedViewResolver viewResolver = <span class="keyword">new</span> UrlBasedViewResolver();
  viewResolver.setViewClass(TilesView.class);
  <span class="keyword">return</span> viewResolver;
}

<span class="annotation">@Bean</span>
TilesConfigurer tilesConfigurer() {
  TilesConfigurer tilesConfig = <span class="keyword">new</span> TilesConfigurer();
  tilesConfig.setDefinitions(<span class="string"><span class="delimiter">&quot;</span><span class="content">/WEB-INF/tiles.xml</span><span class="delimiter">&quot;</span></span>);
  <span class="keyword">return</span> tilesConfig;
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="internationalization-i18n"><a class="anchor" href="#internationalization-i18n"></a>Internationalization (i18n)</h3>
<div class="paragraph">
<p>Concerning internationalization (i18n), the <a href="https://ec.europa.eu/growth/tools-databases/espd/">ESPD</a> application takes advantage of the auto-configuration provided
by <a href="http://projects.spring.io/spring-boot/">Spring Boot</a> in the <code>MessageSourceAutoConfiguration</code> class.</p>
</div>
<div class="listingblock">
<div class="title">application.properties</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="properties"># The location to the resource bundles needed by i18n
spring.messages.basename=i18n/messages

# Loaded resource bundle files cache expiration, in seconds. When set to -1, bundles are cached forever.
spring.messages.cache-seconds=3</code></pre>
</div>
</div>
<div class="paragraph">
<p>The message files are located in the <code>src/main/resources/i18n</code> folder and follow a very simple naming convention of
<code>messages_${locale language}</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <code>application.properties</code> file which is used only for local development is able to
refresh potential changes in the message files without requiring a server restart by specifying the
<code>spring.messages.cache-seconds</code> property.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The corresponding Java configuration is summarized below.</p>
</div>
<div class="listingblock">
<div class="title">WebConfiguration.java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">org.springframework.context.annotation.Bean</span>;
<span class="keyword">import</span> <span class="include">org.springframework.web.servlet.LocaleResolver</span>;
<span class="keyword">import</span> <span class="include">org.springframework.web.servlet.i18n.CookieLocaleResolver</span>;
<span class="keyword">import</span> <span class="include">org.springframework.web.servlet.i18n.LocaleChangeInterceptor</span>;
<span class="keyword">import</span> <span class="include">org.springframework.web.servlet.config.annotation.InterceptorRegistry</span>;

<span class="annotation">@Bean</span>
LocaleChangeInterceptor localeChangeInterceptor() {
  LocaleChangeInterceptor lci = <span class="keyword">new</span> LocaleChangeInterceptor();
  lci.setParamName(<span class="string"><span class="delimiter">&quot;</span><span class="content">lang</span><span class="delimiter">&quot;</span></span>);
  <span class="keyword">return</span> lci;
}

<span class="annotation">@Bean</span>
LocaleResolver localeResolver() {
  CookieLocaleResolver resolver = <span class="keyword">new</span> CookieLocaleResolver();
  resolver.setCookieName(<span class="string"><span class="delimiter">&quot;</span><span class="content">ESPD_LOCALE</span><span class="delimiter">&quot;</span></span>);
  resolver.setDefaultLocale(<span class="predefined-type">Locale</span>.ENGLISH);
  <span class="keyword">return</span> resolver;
}

<span class="annotation">@Override</span>
<span class="directive">public</span> <span class="type">void</span> addInterceptors(InterceptorRegistry registry) {
  registry.addInterceptor(localeChangeInterceptor());
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>LocaleResolver</code> enables the application to automatically resolve messages files using the clientâ€™s locale which
is stored in a <code>ESPD_LOCALE</code> <code>cookie</code>.</p>
</div>
<div class="paragraph">
<p>The <code>LocaleChangeInterceptor</code> uses an HTTP request parameter named <code>lang</code> to detect the language changes on the server side.</p>
</div>
</div>
<div class="sect2">
<h3 id="web-resources-optimization"><a class="anchor" href="#web-resources-optimization"></a>Web Resources Optimization</h3>
<div class="sect3">
<h4 id="static-resources"><a class="anchor" href="#static-resources"></a>Static resources</h4>
<div class="paragraph">
<p><a href="https://ec.europa.eu/growth/tools-databases/espd/">ESPD</a> uses advanced resource handling features provided by <a href="http://docs.spring.io/spring/docs/current/spring-framework-reference/htmlsingle/#mvc-config-static-resources">Spring MVC</a> and <a href="http://docs.spring.io/spring-boot/docs/current/reference/htmlsingle/#boot-features-spring-mvc-static-content">Spring Boot</a>.
We have chosen a path that relies on optimizing resources at build-time using <a href="https://github.com/wro4j/wro4j">WRO4J</a> and leveraging Spring MVC
Resolvers and Transformers and <a href="https://github.com/wro4j/wro4j">WRO4J</a> filter at run-time.</p>
</div>
<div class="paragraph">
<p>The static resources of the application (Javascript and CSS files) are versioned using a content-based hashing strategy
and handled with the idea of <code>cache busting</code> where resources are served with aggressive HTTP cache directives
(e.g. 1 year into the future) and relying on version-related changes in the URL to "bust" the cache when necessary.
The content-based hash version changes whenever the content of the file changes and this happens at build time.</p>
</div>
<div class="listingblock">
<div class="title">application-dev.properties</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="properties"># Cache period for the resources served by the resource handler, in seconds (1 year).
spring.resources.cache-period=31622400

# Enable the Spring Resource Handling chain.
spring.resources.chain.enabled=true

# Enable the content Version Strategy.
spring.resources.chain.strategy.content.enabled=true

# Comma-separated list of patterns to apply to the Version Strategy.
spring.resources.chain.strategy.content.paths=/static/bundle/**</code></pre>
</div>
</div>
<div class="paragraph">
<p>Links to resources are rewritten at run-time using a <code>ResourceUrlEncodingFilter</code>.</p>
</div>
<div class="listingblock">
<div class="title">WebConfiguration.java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">org.springframework.web.servlet.resource.ResourceUrlEncodingFilter</span>;
<span class="keyword">import</span> <span class="include">org.springframework.context.annotation.Bean</span>;

<span class="comment">/**
* If the template engine you are using calls the response encodeURL() method, the version information
* will be automatically added to the URL of the static resources that will be cached.
* This will work in JSPs in conjunction with spring:url tag.
* &lt;p&gt;It needs to be mapped on '/*'.&lt;/p&gt;
*
* @return
*/</span>
<span class="annotation">@Bean</span>
ResourceUrlEncodingFilter resourceUrlEncodingFilter() {
  <span class="keyword">return</span> <span class="keyword">new</span> ResourceUrlEncodingFilter();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>And this is how the static resources are referenced in the view part:</p>
</div>
<div class="listingblock">
<div class="title">espdTemplate.jsp</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="html"><span class="tag">&lt;link</span> <span class="attribute-name">rel</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">stylesheet</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">text/css</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">href</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">&lt;s:url value=</span><span class="delimiter">&quot;</span></span><span class="error">/</span><span class="attribute-name">static</span><span class="error">/</span><span class="attribute-name">bundle</span><span class="error">/</span><span class="attribute-name">all.css</span><span class="error">&quot;</span><span class="tag">/&gt;</span>&quot;<span class="error">&gt;</span>
<span class="tag">&lt;script</span> <span class="attribute-name">src</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">&lt;s:url value=</span><span class="delimiter">&quot;</span></span><span class="error">/</span><span class="attribute-name">static</span><span class="error">/</span><span class="attribute-name">bundle</span><span class="error">/</span><span class="attribute-name">all.js</span><span class="error">&quot;</span><span class="tag">/&gt;</span>&quot;<span class="error">&gt;</span><span class="tag">&lt;/script&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>For example, a request made to the <code>all.js</code> file would be translated into a request made to a Javascript file with a hash:
<code><a href="https://ec.europa.eu/growth/tools-databases/espd/static/bundle/all-60d9cd4aee2d53a2a4bd69a5546a9d18.js" class="bare">https://ec.europa.eu/growth/tools-databases/espd/static/bundle/all-60d9cd4aee2d53a2a4bd69a5546a9d18.js</a></code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="wro4j"><a class="anchor" href="#wro4j"></a>WRO4J</h4>
<div class="paragraph">
<p>Another set of static resources optimizations are handled with <a href="https://github.com/wro4j/wro4j">WRO4J</a> using a simple Java filter at run-time and the
<a href="http://wro4j.readthedocs.org/en/stable/MavenPlugin/">Maven plugin</a> at build-time. <a href="https://github.com/wro4j/wro4j">WRO4J</a> concatenates and minifies
the static resources like Javascript or CSS files into a single file per each type of resource so that the number of HTTP
requests made by the clients that load the application is reduced drastically.</p>
</div>
<div class="sect4">
<h5 id="run-time-solution-with-a-servlet-filter"><a class="anchor" href="#run-time-solution-with-a-servlet-filter"></a>Run-time solution with a Servlet filter</h5>
<div class="paragraph">
<p>The Java filter configuration makes use of <a href="http://projects.spring.io/spring-boot/">Spring Boot</a> auto-configuration provided by the <a href="https://github.com/michael-simons/wro4j-spring-boot-starter">wro4j-spring-boot-starter</a> library.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This is only used by the <code>default</code> <a href="http://projects.spring.io/spring-boot/">Spring Boot</a> profile which should be active only at development time.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">Wroj4Config.java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">ac.simons.spring.boot.wro4j.Wro4jAutoConfiguration</span>;
<span class="keyword">import</span> <span class="include">org.springframework.context.annotation.Configuration</span>;
<span class="keyword">import</span> <span class="include">org.springframework.context.annotation.Profile</span>;

<span class="annotation">@Profile</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">default</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@Configuration</span>
<span class="type">class</span> <span class="class">Wro4jConfig</span> <span class="directive">extends</span> Wro4jAutoConfiguration {

  <span class="comment">// only used for development ('default' profile) when we need the Wro4J Filter</span>

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The run-time properties are defined in the <code>application.properties</code> file.</p>
</div>
<div class="listingblock">
<div class="title">application.properties</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="properties"># Integer value for specifying how often (in seconds) the resource changes should be checked. When this value is 0,
# the cache is never refreshed. When a resource change is detected, the cached group containing changed resource
# will be invalidated. This is useful during development, when resources are changed often.
wro4j.resourceWatcherUpdatePeriod=3

# Integer value for specifying how often (in seconds) the cache should be refreshed.
# When this value is 0, the cache is never refreshed.
wro4j.cacheUpdatePeriod=3

wro4j.disableCache=true

wro4j.debug=true

wro4j.filterUrl=/static/bundle

# A comma separated values describing pre processor aliases to be used during processing.
wro4j.managerFactory.preProcessors=fallbackCssDataUri, cssUrlRewriting, cssImport, semicolonAppender, cssMinJawr, jsMin</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="build-time-solution-with-maven"><a class="anchor" href="#build-time-solution-with-maven"></a>Build-time solution with Maven</h5>
<div class="paragraph">
<p>The build-time solution uses a <a href="https://maven.apache.org">Maven 3</a> plugin and needs two <a href="https://github.com/wro4j/wro4j">WRO4J</a> configuration files placed under the
<code>src/main/resources</code> folder.</p>
</div>
<div class="listingblock">
<div class="title">wro.xml</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;groups</span> <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.isdc.ro/wro</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
  <span class="tag">&lt;group</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">all</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;css</span> <span class="attribute-name">minimize</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">false</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>/static/bootstrap-3.2.0/css/bootstrap.min.css<span class="tag">&lt;/css&gt;</span>
    <span class="tag">&lt;css</span> <span class="attribute-name">minimize</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">true</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>/static/css/espd.css<span class="tag">&lt;/css&gt;</span>

    <span class="tag">&lt;js</span> <span class="attribute-name">minimize</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">false</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>/static/jquery/jquery.min.js<span class="tag">&lt;/js&gt;</span>
    <span class="tag">&lt;js</span> <span class="attribute-name">minimize</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">false</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>/static/bootstrap-3.2.0/js/bootstrap.min.js<span class="tag">&lt;/js&gt;</span>
    <span class="tag">&lt;js</span> <span class="attribute-name">minimize</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">true</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>/static/js/init.js<span class="tag">&lt;/js&gt;</span>
  <span class="tag">&lt;/group&gt;</span>
<span class="tag">&lt;/groups&gt;</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">wro.properties</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="properties">###############################################################################
#####     THIS FILE IS USED AT BUILD TIME BY THE WRO4J MAVEN PLUGIN      ######
###############################################################################

#If true, it is DEVELOPMENT mode, by default this value is true.
debug=false

# A comma separated values describing pre processor aliases to be used during processing.
preProcessors=fallbackCssDataUri,cssUrlRewriting,cssImport,semicolonAppender

postProcessors=cssVariables,cssMinJawr,jsMin

# The alias of the HashStrategy used to compute ETags &amp; cache keys.
hashStrategy=MD5

# The alias of the NamingStrategy used to rename bundles.
namingStrategy=noOp</code></pre>
</div>
</div>
<div class="paragraph">
<p>The Maven plugin bundles all the Javascript and CSS files into the <code>src/main/webapp/static/bundle</code> folder,
applying minimization where necessary and creating a <code>all.js</code> and a <code>all.css</code> file.</p>
</div>
<div class="listingblock">
<div class="title">espd-web.pom.xml</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;configuration&gt;</span>
  <span class="tag">&lt;wroFile&gt;</span>${basedir}/src/main/resources/wro.xml<span class="tag">&lt;/wroFile&gt;</span>
  <span class="tag">&lt;extraConfigFile&gt;</span>${basedir}/src/main/resources/wro.properties<span class="tag">&lt;/extraConfigFile&gt;</span>
  <span class="tag">&lt;cssDestinationFolder&gt;</span>${basedir}/src/main/webapp/static/bundle/<span class="tag">&lt;/cssDestinationFolder&gt;</span>
  <span class="tag">&lt;jsDestinationFolder&gt;</span>${basedir}/src/main/webapp/static/bundle/<span class="tag">&lt;/jsDestinationFolder&gt;</span>
  <span class="tag">&lt;wroManagerFactory&gt;</span>ro.isdc...factory.ConfigurableWroManagerFactory<span class="tag">&lt;/wroManagerFactory&gt;</span>
  <span class="tag">&lt;ignoreMissingResources&gt;</span>false<span class="tag">&lt;/ignoreMissingResources&gt;</span>
  <span class="tag">&lt;incrementalBuildEnabled&gt;</span>true<span class="tag">&lt;/incrementalBuildEnabled&gt;</span>
<span class="tag">&lt;/configuration&gt;</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="lombok"><a class="anchor" href="#lombok"></a>Lombok</h3>
<div class="paragraph">
<p>To reduce some of the <code>boilerplate</code> inherent to the Java language, the project uses the <a href="https://projectlombok.org/features/index.html">Lombok</a> library to try to
reduce some of the annoyances of the language by using Java annotations.</p>
</div>
<div class="paragraph">
<p>The library is usable in <a href="https://eclipse.org/downloads">Eclipse</a> by double clicking the <code>lombok.jar</code> and in <a href="https://www.jetbrains.com/idea">IntelliJ</a> by installing the <a href="https://plugins.jetbrains.com/plugin/6317">Lombok plugin</a>.</p>
</div>
<div class="paragraph">
<p>If you do not like the basic idea behind <a href="https://projectlombok.org/features/index.html">Lombok</a> you can <a href="https://projectlombok.org/features/delombok.html">delombok</a> the source code and
go back to standard Java source code.</p>
</div>
<div class="paragraph">
<p>Here is a very simple example of how <a href="https://projectlombok.org/features/index.html">Lombok</a> might be used inside the <a href="https://ec.europa.eu/growth/tools-databases/espd/">ESPD</a> project.</p>
</div>
<div class="listingblock">
<div class="title">TedRequest.java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">lombok.Builder</span>;
<span class="keyword">import</span> <span class="include">lombok.Getter</span>;

<span class="annotation">@Builder</span>
<span class="annotation">@Getter</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">TedRequest</span> {

  <span class="directive">private</span> <span class="predefined-type">String</span> receptionId;

}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">LombokExample.java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> TedRequest prepare() {
  TedRequest request = TedRequest.builder()
                    .receptionId(<span class="string"><span class="delimiter">&quot;</span><span class="content">16-000136-001</span><span class="delimiter">&quot;</span></span>)
                    .build();
  log.debug(<span class="string"><span class="delimiter">&quot;</span><span class="content">This is the reception id: '{}'.</span><span class="delimiter">&quot;</span></span>, request.getReceptionId());
  <span class="keyword">return</span> request;
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="logging"><a class="anchor" href="#logging"></a>Logging</h3>
<div class="paragraph">
<p>Logging in the application is handled using the <a href="http://www.slf4j.org/">SLF4J</a> API and the chosen implementation is provided
by the <a href="http://logback.qos.ch/">Logback</a> library.</p>
</div>
<div class="paragraph">
<p>Since the <strong>espd-web</strong> module depends on <code>spring-boot-starter-web</code> and this one transitively depends on <code>spring-boot-starter-logging</code>,
the default logging implementation configured by <a href="http://projects.spring.io/spring-boot/">Spring Boot</a> is <a href="http://logback.qos.ch/">Logback</a>.</p>
</div>
<div class="paragraph">
<p>The <code>application-${profile}.properties</code> files declare the path to the <a href="http://logback.qos.ch/">Logback</a> configuration. The logging configuration
files are stored in the <code>espd-web/src/main/resources/logback</code> folder.</p>
</div>
<div class="listingblock">
<div class="title">application-dev.properties</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="properties"># The path to the logback configuration file depending on the profile
logging.config=classpath:logback/logback-dev.xml</code></pre>
</div>
</div>
<div class="paragraph">
<p>To use logging in the code, you can take advantage of the facilities provided by <a href="https://projectlombok.org/features/index.html">Lombok</a>.</p>
</div>
<div class="listingblock">
<div class="title">Logging.java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">lombok.extern.slf4j.Slf4j</span>;

<span class="annotation">@Slf4j</span>
<span class="type">class</span> <span class="class">Logging</span> {

  <span class="type">void</span> logSomething(<span class="predefined-type">String</span> parameter) {
    log.info(<span class="string"><span class="delimiter">&quot;</span><span class="content">Logging the following value '{}'.</span><span class="delimiter">&quot;</span></span>, parameter);
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="monitoring-and-analytics"><a class="anchor" href="#monitoring-and-analytics"></a>Monitoring and analytics</h3>
<div class="sect3">
<h4 id="java-melody"><a class="anchor" href="#java-melody"></a>Java Melody</h4>
<div class="paragraph">
<p>Basic monitoring of the <a href="https://ec.europa.eu/growth/tools-databases/espd/">ESPD</a> application is handled using the <a href="https://github.com/javamelody/javamelody/wiki">Java Melody</a> library by registering a Java filter
inside the Spring application context.</p>
</div>
<div class="listingblock">
<div class="title">WebConfiguration.java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">org.springframework.context.annotation.Bean</span>;
<span class="keyword">import</span> <span class="include">net.bull.javamelody.MonitoringFilter</span>;
<span class="keyword">import</span> <span class="include">net.bull.javamelody.Parameter</span>;

<span class="annotation">@Bean</span>
MonitoringFilter melodyMonitoringFilter() {
  <span class="keyword">return</span> <span class="keyword">new</span> MonitoringFilter();
}

<span class="annotation">@Bean</span>
FilterRegistrationBean melodyFilterRegistration(MonitoringFilter melodyFilter) {
  FilterRegistrationBean frb = <span class="keyword">new</span> FilterRegistrationBean(melodyFilter);
  frb.addInitParameter(Parameter.NO_DATABASE.getCode(), <span class="string"><span class="delimiter">&quot;</span><span class="content">true</span><span class="delimiter">&quot;</span></span>);
  frb.addInitParameter(Parameter.ALLOWED_ADDR_PATTERN.getCode(),
        <span class="string"><span class="delimiter">&quot;</span><span class="content">(158</span><span class="char">\\</span><span class="content">.16[6-8]</span><span class="char">\\</span><span class="content">..*)|(127</span><span class="char">\\</span><span class="content">.0</span><span class="char">\\</span><span class="content">.0</span><span class="char">\\</span><span class="content">.1)|(localhost)</span><span class="delimiter">&quot;</span></span>);
  frb.addInitParameter(Parameter.URL_EXCLUDE_PATTERN.getCode(), <span class="string"><span class="delimiter">&quot;</span><span class="content">(/img/.*)|(/js/.*)|(/css/.*)|(.*/.woff)</span><span class="delimiter">&quot;</span></span>);
  <span class="keyword">return</span> frb;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The filter configuration makes the monitoring accessible only to a certain range of IP addresses, excludes requests
pointing to static resources and specifies that no database monitoring should be active.</p>
</div>
<div class="paragraph">
<p>Additional monitoring capabilities could be added by activating the <a href="http://docs.spring.io/spring-boot/docs/current/reference/htmlsingle/#production-ready">Spring Boot actuator</a> features.</p>
</div>
</div>
<div class="sect3">
<h4 id="piwik"><a class="anchor" href="#piwik"></a>Piwik</h4>
<div class="paragraph">
<p>Analytics capabilities for the application are provided via the <a href="http://piwik.org/">Piwik</a> server of DG Growth.</p>
</div>
<div class="listingblock">
<div class="title">application-dev.properties</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="properties"># Enable or disable the Piwik integration
piwik.enabled=false

# Piwik id for ESPD project
piwik.id=2

# Piwik server for ESPD project
piwik.server=https://webgate.ec.europa.eu/pwar/piwik.php</code></pre>
</div>
</div>
<div class="paragraph">
<p>[NOTE] You might want to disable the integration with the Piwik server of DG Growth by setting the <code>piwik.enabled</code>
parameter to <code>false</code> in the corresponding <code>application.properties</code> file.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="criteria-definitions"><a class="anchor" href="#criteria-definitions"></a>Criteria definitions</h3>
<div class="paragraph">
<p>With the <code>2016.06</code> version, the criteria requirement groups have been restructured with regards to interoperability with
the VCD application and three JSON files have been added under <code>src/main/resources/criteria</code>. These files contain the
definitions for the exclusion, selection and other criteria used by the static version of <a href="https://ec.europa.eu/growth/tools-databases/espd/">ESPD</a>.</p>
</div>
<div class="listingblock">
<div class="title">exclusionCriterion.json</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="javascript">{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Conflict of interest due to its participation in the procurement procedure</span><span class="delimiter">&quot;</span></span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">uuid</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">b1b5ac18-f393-4280-9659-1367943c1a2e</span><span class="delimiter">&quot;</span></span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">shortName</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Conflict of interest due to its participation in the procurement procedure</span><span class="delimiter">&quot;</span></span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">description</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Is the economic operator aware of any conflict of interest, as indicated in national law, the relevant notice or the procurement documents due to its participation in the procurement procedure?</span><span class="delimiter">&quot;</span></span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">criterionType</span><span class="delimiter">&quot;</span></span>: {
    <span class="key"><span class="delimiter">&quot;</span><span class="content">description</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Grounds for exclusion relating to possible conflicts of interests</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">espdType</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">CONFLICT_OF_INTEREST</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">code</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">CRITERION.EXCLUSION.CONFLICT_OF_INTEREST.PROCEDURE_PARTICIPATION</span><span class="delimiter">&quot;</span></span>
  },
  <span class="key"><span class="delimiter">&quot;</span><span class="content">legislationReference</span><span class="delimiter">&quot;</span></span>: {
     <span class="key"><span class="delimiter">&quot;</span><span class="content">title</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">DIRECTIVE 2014/24/EU OF THE EUROPEAN PARLIAMENT AND OF THE COUNCIL of 26 February 2014 on public procurement and repealing Directive 2004/18/EC</span><span class="delimiter">&quot;</span></span>,
     <span class="key"><span class="delimiter">&quot;</span><span class="content">description</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Directive 2014/24/EU</span><span class="delimiter">&quot;</span></span>,
     <span class="key"><span class="delimiter">&quot;</span><span class="content">url</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">http://eur-lex.europa.eu/legal-content/EN/TXT/?uri=celex:32014L0024</span><span class="delimiter">&quot;</span></span>,
     <span class="key"><span class="delimiter">&quot;</span><span class="content">article</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">57(4)</span><span class="delimiter">&quot;</span></span>
  },
  <span class="key"><span class="delimiter">&quot;</span><span class="content">groups</span><span class="delimiter">&quot;</span></span>: [
    {
    <span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">G1</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">30450436-f559-4dfa-98ba-f0842ed9d2a0</span><span class="delimiter">&quot;</span></span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">requirements</span><span class="delimiter">&quot;</span></span>: [
      {
      <span class="key"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">974c8196-9d1c-419c-9ca9-45bb9f5fd59a</span><span class="delimiter">&quot;</span></span>,
      <span class="key"><span class="delimiter">&quot;</span><span class="content">description</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Your answer?</span><span class="delimiter">&quot;</span></span>,
      <span class="key"><span class="delimiter">&quot;</span><span class="content">responseType</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">INDICATOR</span><span class="delimiter">&quot;</span></span>,
      <span class="key"><span class="delimiter">&quot;</span><span class="content">espdCriterionFields</span><span class="delimiter">&quot;</span></span>: [
          <span class="string"><span class="delimiter">&quot;</span><span class="content">answer</span><span class="delimiter">&quot;</span></span>
      ]
      }
    ]
    }
  ],
  <span class="key"><span class="delimiter">&quot;</span><span class="content">espdDocumentField</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">conflictInterest</span><span class="delimiter">&quot;</span></span>
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="jaxb"><a class="anchor" href="#jaxb"></a>JAXB</h3>
<div class="paragraph">
<p>The marshalling and unmarshalling of the XML files produced by the application is handled by a <a href="http://docs.spring.io/spring/docs/current/spring-framework-reference/htmlsingle/#oxm-jaxb">Spring Jaxb2Marshaller</a>.</p>
</div>
<div class="paragraph">
<p>The <a href="https://jaxb.java.net">JAXB</a> configuration declares the packages to be scanned for potential <a href="https://jaxb.java.net">JAXB</a> annotated classes which are located in the
<code>exchange-model</code> Maven module.</p>
</div>
<div class="listingblock">
<div class="title">JaxbConfiguration.java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">grow.names.specification.ubl.schema.xsd.espdrequest_1.ESPDRequestType</span>;
<span class="keyword">import</span> <span class="include">grow.names.specification.ubl.schema.xsd.espdresponse_1.ESPDResponseType</span>;
<span class="keyword">import</span> <span class="include">org.springframework.context.annotation.Bean</span>;
<span class="keyword">import</span> <span class="include">org.springframework.context.annotation.Configuration</span>;
<span class="keyword">import</span> <span class="include">org.springframework.oxm.jaxb.Jaxb2Marshaller</span>;
<span class="keyword">import</span> <span class="include">javax.xml.bind.Marshaller</span>;
<span class="keyword">import</span> <span class="include">java.util.HashMap</span>;
<span class="keyword">import</span> <span class="include">java.util.Map</span>;

<span class="annotation">@Configuration</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">JaxbConfiguration</span> {

<span class="annotation">@Bean</span>
<span class="directive">public</span> Jaxb2Marshaller jaxb2Marshaller() {
    Jaxb2Marshaller jaxb2Marshaller = <span class="keyword">new</span> Jaxb2Marshaller();
    jaxb2Marshaller.setPackagesToScan(ESPDRequestType.class.getPackage().getName(),
            ESPDResponseType.class.getPackage().getName());
    <span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">Object</span>&gt; map = <span class="keyword">new</span> <span class="predefined-type">HashMap</span>&lt;&gt;(<span class="integer">2</span>);
    map.put(Marshaller.JAXB_FORMATTED_OUTPUT, <span class="predefined-constant">true</span>);
    jaxb2Marshaller.setMarshallerProperties(map);
    <span class="keyword">return</span> jaxb2Marshaller;
  }
}</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="date-and-time"><a class="anchor" href="#date-and-time"></a>Date and time</h4>
<div class="paragraph">
<p>Date and time objects are handled with the <a href="http://www.joda.org/joda-time/">Joda-Time</a> library. There are two adapters that are used to populate the Date
objects inside the <a href="https://jaxb.java.net">JAXB</a> POJOs. These adapters convert and parse <code>String</code> objects into <code>LocalDate</code> or <code>LocalTime</code>
<a href="http://www.joda.org/joda-time/">Joda-Time</a> objects.</p>
</div>
<div class="listingblock">
<div class="title">LocalDateAdapter.java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">org.joda.time.LocalDate</span>;
<span class="keyword">import</span> <span class="include">org.joda.time.format.DateTimeFormat</span>;
<span class="keyword">import</span> <span class="include">org.joda.time.format.DateTimeFormatter</span>;

<span class="directive">public</span> <span class="directive">final</span> <span class="type">class</span> <span class="class">LocalDateAdapter</span> {

  <span class="directive">private</span> <span class="directive">static</span> <span class="directive">final</span> DateTimeFormatter DATE_FORMAT = DateTimeFormat.forPattern(<span class="string"><span class="delimiter">&quot;</span><span class="content">YYYY-MM-dd</span><span class="delimiter">&quot;</span></span>);

  <span class="directive">private</span> LocalDateAdapter() {

  }

  <span class="directive">public</span> <span class="directive">static</span> LocalDate unmarshal(<span class="predefined-type">String</span> v) {
      <span class="keyword">return</span> LocalDate.parse(v, DATE_FORMAT);
  }

  <span class="directive">public</span> <span class="directive">static</span> <span class="predefined-type">String</span> marshal(LocalDate v) {
      <span class="keyword">return</span> v.toString(DATE_FORMAT);
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The mapping of the date adapters is done in the <a href="https://jaxb.java.net">JAXB</a> <code>bindings.xjb</code> configuration file inside the <code>exchange-model</code> module.</p>
</div>
<div class="listingblock">
<div class="title">bindings.xjb</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;jxb:globalBindings&gt;</span>
  <span class="tag">&lt;jxb:javaType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">org.joda.time.LocalDate</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">xmlType</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xs:date</span><span class="delimiter">&quot;</span></span>
    <span class="attribute-name">parseMethod</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">eu.europa.ec.grow.espd.xml.LocalDateAdapter.unmarshal</span><span class="delimiter">&quot;</span></span>
    <span class="attribute-name">printMethod</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">eu.europa.ec.grow.espd.xml.LocalDateAdapter.marshal</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;jxb:javaType</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">org.joda.time.LocalTime</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">xmlType</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xs:time</span><span class="delimiter">&quot;</span></span>
    <span class="attribute-name">parseMethod</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">eu.europa.ec.grow.espd.xml.LocalTimeAdapter.unmarshal</span><span class="delimiter">&quot;</span></span>
    <span class="attribute-name">printMethod</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">eu.europa.ec.grow.espd.xml.LocalTimeAdapter.marshal</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;jxb:serializable</span> <span class="attribute-name">uid</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">100</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
<span class="tag">&lt;/jxb:globalBindings&gt;</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="rest-template"><a class="anchor" href="#rest-template"></a>REST template</h3>
<div class="paragraph">
<p>The interaction with external RESTful APIs (e.g. TED) is done with the <a href="http://docs.spring.io/spring/docs/current/spring-framework-reference/htmlsingle/#rest-client-access">Spring RestTemplate</a>.</p>
</div>
<div class="paragraph">
<p>There is one global Spring bean of type <code>RestTemplate</code> defined in the application.</p>
</div>
<div class="listingblock">
<div class="title">EspdApplication.java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">com.fasterxml.jackson.databind.ObjectMapper</span>;
<span class="keyword">import</span> <span class="include">org.springframework.beans.factory.annotation.Value</span>;
<span class="keyword">import</span> <span class="include">org.springframework.boot.SpringApplication</span>;
<span class="keyword">import</span> <span class="include">org.springframework.boot.autoconfigure.SpringBootApplication</span>;
<span class="keyword">import</span> <span class="include">org.springframework.boot.builder.SpringApplicationBuilder</span>;
<span class="keyword">import</span> <span class="include">org.springframework.boot.context.web.SpringBootServletInitializer</span>;
<span class="keyword">import</span> <span class="include">org.springframework.context.annotation.Bean</span>;
<span class="keyword">import</span> <span class="include">org.springframework.context.annotation.ComponentScan</span>;
<span class="keyword">import</span> <span class="include">org.springframework.http.client.SimpleClientHttpRequestFactory</span>;
<span class="keyword">import</span> <span class="include">org.springframework.web.WebApplicationInitializer</span>;
<span class="keyword">import</span> <span class="include">org.springframework.web.client.RestTemplate</span>;

<span class="annotation">@SpringBootApplication</span>
<span class="annotation">@ComponentScan</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">eu.europa.ec.grow.espd</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">EspdApplication</span> <span class="directive">extends</span> SpringBootServletInitializer <span class="directive">implements</span> WebApplicationInitializer {

  <span class="annotation">@Value</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">${http.client.connect.timeout.millis:30000}</span><span class="delimiter">&quot;</span></span>)
  <span class="directive">private</span> <span class="type">int</span> connectTimeout;

  <span class="annotation">@Bean</span>
  ObjectMapper objectMapper() {
    <span class="keyword">return</span> <span class="keyword">new</span> ObjectMapper();
  }

  <span class="annotation">@Bean</span>
  RestTemplate restTemplate() {
    RestTemplate restTemplate = <span class="keyword">new</span> RestTemplate();

    SimpleClientHttpRequestFactory rf = (SimpleClientHttpRequestFactory) restTemplate.getRequestFactory();
    rf.setReadTimeout(connectTimeout);
    rf.setConnectTimeout(connectTimeout);

    <span class="keyword">return</span> restTemplate;
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can find an example of how to use the <code>RestTemplate</code> in the <code>eu.europa.ec.grow.espd.ted.TedService</code> class.</p>
</div>
</div>
<div class="sect2">
<h3 id="ted-rest-service"><a class="anchor" href="#ted-rest-service"></a>TED REST service</h3>
<div class="paragraph">
<p>Information about the procurement procedure can be provided by the publication office via the TED REST service.
In order to be able to retrieve the information from their remote service we need to provide four parameters.</p>
</div>
<div class="listingblock">
<div class="title">application-dev.properties</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="properties"># The base URL of the TED contract notice REST service
ted.api.base.url=https://esentool.ted.europa.eu/api/espd/v1.0/notice

# Timeout in milliseconds for the Spring RestTemplate client
rest.template.connect.timeout.millis=30000

# user for TED API
ted.api.user=passed as server startup parameter

# Password for TED API
ted.api.password=passed as server startup parameter</code></pre>
</div>
</div>
<div class="paragraph">
<p>The part of the code that handles the TED service can be found in the <code>eu.europa.ec.grow.espd.ted</code> package.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="view"><a class="anchor" href="#view"></a>View</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The client interface is based on the <a href="http://docs.spring.io/autorepo/docs/spring/3.2.x/spring-framework-reference/html/mvc.html">Spring MVC</a> integration with <a href="https://tiles.apache.org/">Apache Tiles</a> working as a template system for the JSP files.
All of the HTML forms are CSS styled with <a href="http://getbootstrap.com/">Twitter Bootstrap</a> and use Spring form tags to do the display and form binding.</p>
</div>
<div class="paragraph">
<p>Every JSP implements a responsive <a href="http://getbootstrap.com/">Twitter Bootstrap</a> grid layout and some <a href="http://getbootstrap.com/">Twitter Bootstrap</a> styles to make it look better.</p>
</div>
<div class="paragraph">
<p><a href="https://tiles.apache.org/">Apache Tiles</a> and the corresponding <code>view resolvers</code> are configured in the <code>WebConfiguration.java</code> file while <code>tiles.xml</code>
contains the configuration for the <a href="https://tiles.apache.org/">Apache Tiles</a> template definitions.</p>
</div>
<div class="sect2">
<h3 id="forms"><a class="anchor" href="#forms"></a>Forms</h3>
<div class="paragraph">
<p>Client web form submission and validation is performed by <a href="http://docs.spring.io/autorepo/docs/spring/3.2.x/spring-framework-reference/html/mvc.html">Spring MVC</a> Form Binding.</p>
</div>
<div class="listingblock">
<div class="title">EspdController.java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@InitBinder</span>
<span class="directive">private</span> <span class="type">void</span> dateBinder(WebDataBinder binder) {
  <span class="predefined-type">SimpleDateFormat</span> dateFormat = <span class="keyword">new</span> <span class="predefined-type">SimpleDateFormat</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">dd-MM-yyyy</span><span class="delimiter">&quot;</span></span>);
  CustomDateEditor editor = <span class="keyword">new</span> CustomDateEditor(dateFormat, <span class="predefined-constant">true</span>);
  binder.registerCustomEditor(<span class="predefined-type">Date</span>.class, editor);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The HTML form is implemented by the <code>spring:form</code> tag to bind the controller object via <code>@ModelAttribute</code>. An
<code>EspdDocument</code> object will be attached to each HTTP session via the <code>@SessionAttributes("espd")</code> declaration and is
reset on each page access to the <code>/welcome</code> page.</p>
</div>
<div class="listingblock">
<div class="title">EspdController.java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@ModelAttribute</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">espd</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> EspdDocument newDocument() {
  <span class="keyword">return</span> <span class="keyword">new</span> EspdDocument();
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="internationalization-i18n-2"><a class="anchor" href="#internationalization-i18n-2"></a>Internationalization (i18n)</h3>
<div class="paragraph">
<p>Any web application with users all around the world, internationalization (i18n) is very important for better user interaction.
ESPD i18n is implemented through the use of Spring <code>interceptors</code>, <code>locale resolvers</code> and <code>resource bundles</code> for different locales.</p>
</div>
<div class="paragraph">
<p><code>LocaleChangeInterceptor</code> and <code>LocaleResolver</code> are configured in the <code>WebConfiguration</code> class.</p>
</div>
<div class="paragraph">
<p>A <code>MessageSource</code> bean is provided by <a href="http://projects.spring.io/spring-boot/">Spring Boot</a> and configured in properties file to enable i18n for the ESPD application.</p>
</div>
<div class="listingblock">
<div class="title">application.properties</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="properties"># The location to the resource bundles needed by i18n
spring.messages.basename=i18n/messages</code></pre>
</div>
</div>
<div class="paragraph">
<p>Translated messages could be retrieved with the given code by the Jsp tag <code>spring:message</code>.</p>
</div>
<div class="listingblock">
<div class="title">example.jsp</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="html"><span class="error">&lt;</span>%@ taglib prefix=&quot;s&quot; uri=&quot;http://www.springframework.org/tags&quot; %<span class="error">&gt;</span>
<span class="tag">&lt;s:message</span> <span class="attribute-name">code</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">createca_postcode</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span><span class="error">&lt;</span>%-- by static code --%<span class="error">&gt;</span>
<span class="tag">&lt;s:message</span> <span class="attribute-name">code</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">${cty.i18nCode}</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span><span class="error">&lt;</span>%-- code from variable --%<span class="error">&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The only part worth mentioning is the use of custom classes providing more efficient use of the <code>MessageSource</code> bean in JSP.
The class <code>I18NFunc</code> provides HTML code generating methods to use in JSPs for translated fields.</p>
</div>
<div class="listingblock">
<div class="title">espdTemplate.jsp</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">&lt;%-- Initialization of request objects --%&gt;
eu.europa.ec.grow.espd.util.I18NFunc inst =
        <span class="keyword">new</span> eu.europa.ec.grow.espd.util.I18NFunc(pageContext);
request.setAttribute(<span class="string"><span class="delimiter">&quot;</span><span class="content">i18n</span><span class="delimiter">&quot;</span></span>, inst.message());
request.setAttribute(<span class="string"><span class="delimiter">&quot;</span><span class="content">div18n</span><span class="delimiter">&quot;</span></span>, inst.div());
request.setAttribute(<span class="string"><span class="delimiter">&quot;</span><span class="content">span18n</span><span class="delimiter">&quot;</span></span>, inst.span());</code></pre>
</div>
</div>
<div class="paragraph">
<p>Using these classes is more concise and the generated code supports translation without page reload.</p>
</div>
<div class="listingblock">
<div class="title">example.jsp</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="html">${i18n['createca_procurer_name']}
${div18n['createca_procurer_name']}
${span18n['createca_procurer_name']}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The JSP code above would generate the following HTML output:</p>
</div>
<div class="listingblock">
<div class="title">example.html</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="html">Title:
<span class="tag">&lt;div</span> <span class="attribute-name">data-i18n</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">createca_procurer_name</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>Title:<span class="tag">&lt;/div&gt;</span>
<span class="tag">&lt;span</span> <span class="attribute-name">data-i18n</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">createca_procurer_name</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>Title:<span class="tag">&lt;/span&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Different combinations of custom i18n code generators provide translation labels, tooltips and placeholders without page reload.</p>
</div>
<div class="listingblock">
<div class="title">example.jsp</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="html"><span class="comment">&lt;!-- label example --&gt;</span>
<span class="tag">&lt;label</span> <span class="attribute-name">class</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">control-label</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
  ${span18n['crit_year']
<span class="tag">&lt;/label&gt;</span>
<span class="comment">&lt;!-- tooltip example --&gt;</span>
<span class="tag">&lt;span</span> <span class="attribute-name">data-toggle</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">tooltip</span><span class="delimiter">&quot;</span></span><span class="attribute-name">data-i18n</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">${tooltip_code}</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">title</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">${tooltip_text}</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
<span class="tag">&lt;/span&gt;</span>
<span class="comment">&lt;!-- placeholder example --&gt;</span>
<span class="tag">&lt;form:input</span> <span class="attribute-name">path</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">field</span><span class="delimiter">&quot;</span></span>
  <span class="attribute-name">cssClass</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">form-control</span><span class="delimiter">&quot;</span></span>
  <span class="attribute-name">data-i18n</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">crit_ratio_placeholder</span><span class="delimiter">&quot;</span></span>
  <span class="attribute-name">placeholder</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">${i18n['crit_ratio_placeholder']}</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="dynamic-web-page-translation"><a class="anchor" href="#dynamic-web-page-translation"></a>Dynamic web page translation</h3>
<div class="paragraph">
<p>The <a href="https://ec.europa.eu/growth/tools-databases/espd/">ESPD</a> web content is translated to another language automatically without page refresh. The dynamic translation is
implemented in Javascript with <a href="https://jquery.com/">jQuery</a> and the translation routine is found in the <code>init.js</code> file. The Javascript client
makes an HTTP call to the <code>/translate</code> mapping defined inside the <code>MessageSourceController</code> class to fetch the required
message labels and afterwards updates the DOM elements containing the <code>data-i18n</code> attribute.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="testing"><a class="anchor" href="#testing"></a>Testing</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Making sure that an application behaves correctly is a difficult job and <a href="https://ec.europa.eu/growth/tools-databases/espd/">ESPD</a> is no exception from this rule, that&#8217;s
why we have an extensive test suite of more than 600 automated unit tests. These tests try to focus on the domain model
marshalling/unmarshalling logic of ESPD Requests and Responses and go into very detailed checks for each criterion,
requirement or other domain entity of the application.</p>
</div>
<div class="paragraph">
<p>The unit tests are written using the <a href="http://spockframework.github.io/spock/docs/1.0/index.html">Spock Framework</a> in the <a href="http://www.groovy-lang.org/">Groovy</a> programming language and we take advantage of its beautiful
and highly expressive specification language.</p>
</div>
<div class="paragraph">
<p>The <a href="https://maven.apache.org">Maven 3</a> configuration for running the tests at build time is defined in the <code>espd-web/pom.xml</code> file. It uses the
<code>gmavenplus-plugin</code> to compile the <a href="http://www.groovy-lang.org/">Groovy</a> test files and the <code>maven-surefire-plugin</code> to specify the file naming pattern
of the tests that are supposed to be run.</p>
</div>
<div class="listingblock">
<div class="title">espd-web/pom.xml</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;plugin&gt;</span>
<span class="comment">&lt;!-- The gmavenplus plugin is used to compile Groovy code. To learn more about this plugin,
visit https://github.com/groovy/GMavenPlus/wiki --&gt;</span>
  <span class="tag">&lt;groupId&gt;</span>org.codehaus.gmavenplus<span class="tag">&lt;/groupId&gt;</span>
  <span class="tag">&lt;artifactId&gt;</span>gmavenplus-plugin<span class="tag">&lt;/artifactId&gt;</span>
  <span class="tag">&lt;version&gt;</span>1.5<span class="tag">&lt;/version&gt;</span>
  <span class="tag">&lt;executions&gt;</span>
    <span class="tag">&lt;execution&gt;</span>
      <span class="tag">&lt;goals&gt;</span>
        <span class="tag">&lt;goal&gt;</span>compile<span class="tag">&lt;/goal&gt;</span>
        <span class="tag">&lt;goal&gt;</span>testCompile<span class="tag">&lt;/goal&gt;</span>
      <span class="tag">&lt;/goals&gt;</span>
    <span class="tag">&lt;/execution&gt;</span>
  <span class="tag">&lt;/executions&gt;</span>
<span class="tag">&lt;/plugin&gt;</span>
<span class="comment">&lt;!-- Optional plugins for using Spock --&gt;</span>
<span class="comment">&lt;!-- Only required if names of spec classes don't match default Surefire patterns (`*Test` etc.) --&gt;</span>
<span class="tag">&lt;plugin&gt;</span>
  <span class="tag">&lt;artifactId&gt;</span>maven-surefire-plugin<span class="tag">&lt;/artifactId&gt;</span>
  <span class="tag">&lt;configuration&gt;</span>
    <span class="tag">&lt;useFile&gt;</span>false<span class="tag">&lt;/useFile&gt;</span>
    <span class="tag">&lt;includes&gt;</span>
      <span class="tag">&lt;include&gt;</span>**/*Spec.java<span class="tag">&lt;/include&gt;</span>
      <span class="tag">&lt;include&gt;</span>**/*Test.java<span class="tag">&lt;/include&gt;</span>
    <span class="tag">&lt;/includes&gt;</span>
  <span class="tag">&lt;/configuration&gt;</span>
<span class="tag">&lt;/plugin&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The tests can be run by invoking a <code>mvn clean package</code> or <code>mvn clean verify</code> command or from the IDE of your choice.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If you are using <a href="https://eclipse.org/downloads">Eclipse</a> you will have to install the <a href="https://github.com/groovy/groovy-eclipse/wiki">Groovy Eclipse plugin</a>.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If you are using <a href="https://www.jetbrains.com/idea">IntelliJ</a> you need to enable the <a href="http://www.groovy-lang.org/">Groovy</a> plugin and it might also be useful to install the <a href="https://plugins.jetbrains.com/plugin/7114?pr=">IntelliJ Spock plugin</a>
for improved working experience.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The location of the tests is under the <code>espd-web/src/test/groovy</code> folder. Inside the <code>eu.europa.ec.grow.espd.xml</code>
package you will find the following sub-packages:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the <strong>base</strong> package contains some basic infrastructure for the unit tests</p>
</li>
<li>
<p>the <strong>request</strong> package contains the tests that handle an ESPD Request</p>
</li>
<li>
<p>the <strong>response</strong> package contains the tests that handle an ESPD Response</p>
</li>
<li>
<p>the <strong>samples</strong> folder contains the XML sample files that are used by the tests that handle the importing of an
ESPD Request or Response</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="anatomy-of-a-test-specification"><a class="anchor" href="#anatomy-of-a-test-specification"></a>Anatomy of a test specification</h3>
<div class="paragraph">
<p>Spock specification classes are derived from <code>spock.lang.Specification</code>. A concrete specification class might consist
of fields, fixture methods, features methods and helper methods.</p>
</div>
<div class="listingblock">
<div class="title">ListSpec.groovy</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">ListSpec</span> <span class="directive">extends</span> Specification {

  <span class="keyword">def</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">adding an element to a list leads to size increase</span><span class="delimiter">&quot;</span></span>() { <i class="conum" data-value="1"></i><b>(1)</b>
    <span class="key">given</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">a new list instance is created</span><span class="delimiter">&quot;</span></span> <i class="conum" data-value="2"></i><b>(2)</b>
    <span class="keyword">def</span> lst = <span class="keyword">new</span> <span class="predefined-type">ArrayList</span>()

    <span class="key">when</span>:
    lst.add(<span class="integer">666</span>) <i class="conum" data-value="3"></i><b>(3)</b>

    <span class="key">then</span>:
    lst.size() == <span class="integer">1</span> <i class="conum" data-value="4"></i><b>(4)</b>
  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Feature method, is by convention named with a descriptive <code>String</code> literal.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><code>Given</code> block, here is where any setup work for this feature needs to be done.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td><code>When</code> block describes a stimulus, a certain action under target by this feature specification.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td><code>Then</code> block contains any expressions that can be used to validate the result of the code that
was triggered by the when block.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Spock feature specifications are defined as methods inside a <code>spock.lang.Specification</code> class. They describe the
feature by using a <code>String</code> literal instead of a method name.</p>
</div>
<div class="paragraph">
<p>A feature method holds multiple blocks, in our example we used <code>given</code>, <code>when</code> and <code>then</code>. The <code>given</code> block is special
in that it is optional and allows us to configure local variables visible inside the feature method. The <code>when</code> block
defines the stimulus and is a companion of the <code>then</code> block which describes the response to the stimulus.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <code>given</code> block is just an alias for the <code>setup</code> block.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Note that the <code>given</code> method in the SpockSpec above additionally has a description <code>String</code>. Description Strings are
optional and can be added after block labels (like <code>given</code>, <code>when</code>, <code>then</code>).</p>
</div>
</div>
<div class="sect2">
<h3 id="testing-the-generation-of-an-xml-file"><a class="anchor" href="#testing-the-generation-of-an-xml-file"></a>Testing the generation of an XML file</h3>
<div class="paragraph">
<p>The code sample below represents a unit test that checks the XML output of an ESPD Response generation, more
specifically the <code>Reason</code> requirement of the <code>Fraud</code> exclusion criterion.</p>
</div>
<div class="listingblock">
<div class="title">FraudResponseTest.groovy</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">FraudResponseTest</span> <span class="directive">extends</span> AbstractExclusionCriteriaFixture {

  <span class="keyword">def</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">check the 'Reason' requirement response</span><span class="delimiter">&quot;</span></span>() {
    <span class="key">given</span>:
    <span class="keyword">def</span> espd = <span class="keyword">new</span> EspdDocument(<span class="key">fraud</span>: <span class="keyword">new</span> CriminalConvictionsCriterion(<span class="key">exists</span>: <span class="predefined-constant">true</span>, <span class="key">reason</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Reason_03 here</span><span class="delimiter">&quot;</span></span>)) <i class="conum" data-value="1"></i><b>(1)</b>

    <span class="key">when</span>:
    <span class="keyword">def</span> response = parseResponseXml(espd) <i class="conum" data-value="2"></i><b>(2)</b>
    <span class="keyword">def</span> idx = getResponseCriterionIndex(ExclusionCriterion.FRAUD)

    <span class="key">then</span>:
    <span class="keyword">def</span> subGroup = response.Criterion[idx].RequirementGroup[<span class="integer">0</span>] <i class="conum" data-value="3"></i><b>(3)</b>
    <span class="keyword">def</span> req = subGroup.Requirement[<span class="integer">2</span>] <i class="conum" data-value="4"></i><b>(4)</b>
    checkRequirement(req, <span class="string"><span class="delimiter">&quot;</span><span class="content">7d35fb7c-da5b-4830-b598-4f347a04dceb</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Reason</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">DESCRIPTION</span><span class="delimiter">&quot;</span></span>) <i class="conum" data-value="5"></i><b>(5)</b>
    req.Response.size() == <span class="integer">1</span> <i class="conum" data-value="6"></i><b>(6)</b>
    req.Response[<span class="integer">0</span>].Description.text() == <span class="string"><span class="delimiter">&quot;</span><span class="content">Reason_03 here</span><span class="delimiter">&quot;</span></span> <i class="conum" data-value="7"></i><b>(7)</b>
  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>given</code> clause initializes the ESPD domain object with the <code>Fraud</code> criterion which contains a <code>Reason</code> with the
text <code>Reason_03 here</code> because the <code>exists</code> flag is set to <code>true</code> on the criterion.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The <code>when</code> clause delegates to the <code>parseResponseXml</code> method from the <code>AbstractEspdXmlMarshalling</code> class which
generates the XML representation of an ESPD Response.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>We get the first <code>requirement group</code> of the <code>Fraud</code> criterion</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>The <code>Reason</code> requirement is the third requirement of the group</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Check the requirement id, description text and response type</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>We should have only a <code>Response</code> XML element</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>Make sure that the description text of the response has the actual value that was supplied in the <code>given</code> clause</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The most common way of querying XML in Groovy is using <code>GPath</code> which is similar to <code>XPath</code> expressions but you can use
it not only with XML but also with POJO classes. More information and examples of using <code>GPath</code> can be found in the
<a href="http://www.groovy-lang.org/">Groovy</a> programming language documentation on <a href="http://groovy-lang.org/processing-xml.html#_gpath">XML processing</a>.</p>
</div>
<div class="paragraph">
<p>The <code>parseResponseXml</code> method uses a <a href="http://www.groovy-lang.org/">Groovy</a> XmlSlurper object which returns GPathResult instances when parsing XML.</p>
</div>
<div class="paragraph">
<p>The <code>then</code> clause makes the business assertions about the expected requirement id, description text, response type
and finally .</p>
</div>
</div>
<div class="sect2">
<h3 id="testing-the-parsing-of-an-xml-file"><a class="anchor" href="#testing-the-parsing-of-an-xml-file"></a>Testing the parsing of an XML file</h3>
<div class="paragraph">
<p>The following example will show a test that reads an <code>ESPD Response</code> XML file and converts it into an ESPD domain
object that is used by the user interface code. The XML sample contains the <code>Setup of economic operator</code> criterion
with the <code>Year</code> requirement value set in the response.</p>
</div>
<div class="listingblock">
<div class="title">SetupEconomicOperatorImportTest.groovy</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">SetupEconomicOperatorImportTest</span> <span class="directive">extends</span> AbstractXmlFileImport {

  <span class="keyword">def</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">10. should import all fields of 'Set up of economic operator'</span><span class="delimiter">&quot;</span></span>() {
    <span class="key">when</span>:
    <span class="keyword">def</span> espd = parseXmlResponseFile(<span class="string"><span class="delimiter">&quot;</span><span class="content">selection/setup_economic_operator_import.xml</span><span class="delimiter">&quot;</span></span>) <i class="conum" data-value="1"></i><b>(1)</b>

    <span class="key">then</span>:
    espd.setupEconomicOperator.exists == <span class="predefined-constant">true</span> <i class="conum" data-value="2"></i><b>(2)</b>

    <span class="key">then</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">selection criteria with no answer have a default value of true</span><span class="delimiter">&quot;</span></span>
    espd.setupEconomicOperator.year1 == <span class="integer">2016</span> <i class="conum" data-value="3"></i><b>(3)</b>
  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Load the XML sample from <code>selection/setup_economic_operator_import.xml</code> and parse it into an <code>EspdDocument</code>
domain object</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Check that the <code>exists</code> indicator has been set for this criterion</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Verify that the <code>Quantity</code> requirement response value stored in <code>year1</code> is <code>2016</code></td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The XML file contains the <code>Setup of economic operator</code> criterion with the <code>Quantity</code> requirement (some of the data
has been removed for clarity):</p>
</div>
<div class="listingblock">
<div class="title">setup_economic_operator_import.xml</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;ccv:Criterion&gt;</span>
  <span class="tag">&lt;ccv:RequirementGroup&gt;</span>
    <span class="tag">&lt;cbc:ID</span> <span class="attribute-name">schemeAgencyID</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">EU-COM-GROW</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">schemeVersionID</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">1.0</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>e9aa7763-c167-4352-8060-1a3d7d3e2662<span class="tag">&lt;/cbc:ID&gt;</span>
    <span class="tag">&lt;ccv:Requirement</span> <span class="attribute-name">responseDataType</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">QUANTITY</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
      <span class="tag">&lt;cbc:ID</span> <span class="attribute-name">schemeID</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">CriterionRelatedIDs</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">schemeAgencyID</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">EU-COM-GROW</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">schemeVersionID</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">1.0</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>a18b2c98-8552-45ca-9751-d4c94c05847a<span class="tag">&lt;/cbc:ID&gt;</span>
      <span class="tag">&lt;cbc:Description&gt;</span>Please specify<span class="tag">&lt;/cbc:Description&gt;</span>
      <span class="tag">&lt;ccv:Response&gt;</span>
        <span class="tag">&lt;cbc:Quantity</span> <span class="attribute-name">unitCode</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">YEAR</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>2016<span class="tag">&lt;/cbc:Quantity&gt;</span>
      <span class="tag">&lt;/ccv:Response&gt;</span>
    <span class="tag">&lt;/ccv:Requirement&gt;</span>
  <span class="tag">&lt;/ccv:RequirementGroup&gt;</span>
<span class="tag">&lt;/ccv:Criterion&gt;</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="data-model"><a class="anchor" href="#data-model"></a>Data model</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The ESPD-EDM model was designed to implement the data requirements expressed in the <code>Annex 2</code> of the <code>COMMISSION IMPLEMENTING
REGULATION (EU) 2016/7 of 5 January 2016</code>, establishing the standard form for the <code>European Single Procurement Document</code>.
Additionally to these requirements, the model also took into account the <code>Information Requirements Model</code> specified in the
<a href="http://www.cenbii.eu/">CEN/BII-Workshops</a> (namely Workshop 3), and the latest developments relating to the <code>Virtual Company
Dossier (VCD)</code> in <a href="http://www.esens.eu/">e-Sens</a>.</p>
</div>
<div class="sect2">
<h3 id="the-espd-request-xml-document-overview"><a class="anchor" href="#the-espd-request-xml-document-overview"></a>The ESPD Request XML document overview</h3>
<div class="paragraph">
<p>The UML Diagram below provides a simplified view of the <code>ESPD Request</code> document. Notice that the classes herein represented
belong to 4 different data-packages. Consequently, each class name is preceded by one of the following prefixes representing
different namespaces: <code>espd</code>, <code>ccv</code>, <code>cev</code>, and <code>cac</code>.</p>
</div>
<div id="img-espd-request" class="imageblock">
<div class="content">
<img src="./images/espd_request.png" alt="espd::ESPDRequest UML class diagram">
</div>
<div class="title">Figure 1. espd::ESPDRequest UML class diagram</div>
</div>
<div class="paragraph">
<p>The figure above provides a high level view of the main concepts used in the ESPD Request relating to the <code>Criterion</code>
entity. The UML diagram below, in turn, shows in detail the classes and attributes of the Core Criterion Data Model
used in the <code>ESPD Request</code> XML document.</p>
</div>
<div id="img-criterion" class="imageblock">
<div class="content">
<img src="./images/criterion.png" alt="UML representation of the parts of the Core Criterion Data Model used in the ESPD Request XML documents">
</div>
<div class="title">Figure 2. UML representation of the parts of the Core Criterion Data Model used in the ESPD Request XML documents</div>
</div>
<div class="paragraph">
<p>The UML diagram can be read as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>One Criterion contains one or more Groups of Requirements</p>
</li>
<li>
<p>One Criterion MAY have sub-Criteria</p>
</li>
<li>
<p>One Criterion MAY be linked to a specific Legislation.</p>
</li>
<li>
<p>One Group of Requirements contains one or more Requirements</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In the ESPD documents a <code>Criterion</code> takes the form of</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>a question or statement about a specific subject that may lead to the exclusion or selection of an <code>Economic Operator</code>
in a <code>Procurement Project</code>.</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>Thus, in the case of grounds for exclusion related to possible convictions, the question</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Has the economic operator itself or any person who is a member of its
administrative, management or supervisory body or has powers of representation, decision or control therein been the
subject of a conviction by final judgement for participation in a criminal organisation, by a conviction rendered at the
most five years ago or in which an exclusion period set out directly in the conviction continues to be applicable?</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>is to be considered a <code>Criterion</code>.</p>
</div>
<div class="paragraph">
<p><code>Requirements</code>, on the other hand, relates to the way the <code>Economic Operator</code> has to answer one specific <code>Criterion</code>.
In the case of the exclusion <code>Criterion</code> mentioned above, the <code>Contracting Authority</code> requires the <code>Economic Operator (EO)</code>
to answer <code>YES</code> or <code>NO</code>, and if the <code>EO</code> answers <code>YES</code>, he is further required to provide additional details about
the conviction.</p>
</div>
</div>
<div class="sect2">
<h3 id="java-packages"><a class="anchor" href="#java-packages"></a>Java packages</h3>
<div class="paragraph">
<p>The <code>exchange-model</code> Maven module contains the XML schemas used to generate the <a href="https://jaxb.java.net">JAXB</a> annotated Java classes.
In the <code>bindings.xjb</code> configuration file we want to specify the desired XML namespace prefixes for the entities involved
in the generation of <code>ESPD-Request</code> or <code>ESPD-Response</code> entities.</p>
</div>
<div class="listingblock">
<div class="title">bindings.xjb</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;jxb:bindings</span> <span class="attribute-name">schemaLocation</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">ESPDRequest-1.0.xsd</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;jxb:bindings&gt;</span>
                <span class="tag">&lt;namespace:prefix</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">espd-req</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;/jxb:bindings&gt;</span>
<span class="tag">&lt;/jxb:bindings&gt;</span>
<span class="tag">&lt;jxb:bindings</span> <span class="attribute-name">schemaLocation</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">ESPDResponse-1.0.xsd</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;jxb:bindings&gt;</span>
                <span class="tag">&lt;namespace:prefix</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">espd</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;/jxb:bindings&gt;</span>
<span class="tag">&lt;/jxb:bindings&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The <a href="https://jaxb.java.net">JAXB</a> POJOs are generated by the <a href="https://java.net/projects/maven-jaxb2-plugin/pages/Home">JAXB2 Maven plugin</a>. The plugin configuration
resides in the <code>exchange-mode/pom.xml</code> file and the generated Java files are stored in the <code>src/main/generated</code> folder that
must be available on the classpath. The plugin will add <code>toString</code>, <code>hashCode</code>, <code>equals</code> methods to the Java classes and
also customize the XML namespace prefixes provided in the sample above.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="release-notes"><a class="anchor" href="#release-notes"></a>Release notes</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="2016-06-01-30th-of-june-2016"><a class="anchor" href="#2016-06-01-30th-of-june-2016"></a>2016.06.01 (30th of June 2016)</h3>
<div class="sect3">
<h4 id="bug"><a class="anchor" href="#bug"></a>Bug</h4>
<div class="ulist">
<ul>
<li>
<p>[ESPD-90] - IE does not allow to copy text with paragraphs in textfield</p>
</li>
<li>
<p>[ESPD-96] - Exclusion ground part C must be preselected</p>
</li>
<li>
<p>[ESPD-104] - We are missing fields for Part VI</p>
</li>
<li>
<p>[ESPD-119] - Incorrect criterion definitions</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="improvement"><a class="anchor" href="#improvement"></a>Improvement</h4>
<div class="ulist">
<ul>
<li>
<p>[ESPD-6] - Use procedure, exclusion as tabs</p>
</li>
<li>
<p>[ESPD-76] - Countries list</p>
</li>
<li>
<p>[ESPD-97] - Re-assign labels in the Home Page</p>
</li>
<li>
<p>[ESPD-100] - Selection criteria requirements duplicate ids</p>
</li>
<li>
<p>[ESPD-106] - Part V should not be shown to CAs</p>
</li>
<li>
<p>[ESPD-108] - VCD issues (continued from version 2016.06)</p>
</li>
<li>
<p>[ESPD-109] - Update of the text on the start page</p>
</li>
<li>
<p>[ESPD-110] - Remove all placeholders from the interface</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="new-feature"><a class="anchor" href="#new-feature"></a>New Feature</h4>
<div class="ulist">
<ul>
<li>
<p>[ESPD-50] - Link to eCertis</p>
</li>
<li>
<p>[ESPD-95] - EO should be able to create an ESPD response from scratch as well</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="2016-06-2nd-of-june-2016"><a class="anchor" href="#2016-06-2nd-of-june-2016"></a>2016.06 (2nd of June 2016)</h3>
<div class="paragraph">
<p>This most important updates of this release are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The restructuring of criterion subgroups in order to achieve a better interoperability with the VCD application</p>
</li>
<li>
<p>Deploy the application as an executable WAR file</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="improvement-2"><a class="anchor" href="#improvement-2"></a>Improvement</h4>
<div class="ulist">
<ul>
<li>
<p>[ESPD-92] - Issues of interoperability with VCD</p>
</li>
<li>
<p>[ESPD-94] - Official name of CA should not be anymore mandatory</p>
</li>
<li>
<p>[ESPD-99] - Deploy the application as an executable WAR file</p>
</li>
<li>
<p>[ESPD-102] - Update breadcrumb</p>
</li>
<li>
<p>[ESPD-107] - Update text in the Home page</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="2016-05-12th-of-may-2016"><a class="anchor" href="#2016-05-12th-of-may-2016"></a>2016.05 (12th of May 2016)</h3>
<div class="paragraph">
<p>The main purpose of this release was to make public the open source version of the ESPD application on Github.</p>
</div>
<div class="sect3">
<h4 id="bug-2"><a class="anchor" href="#bug-2"></a>Bug</h4>
<div class="ulist">
<ul>
<li>
<p>[ESPD-90] - IE does not allow to copy text with paragraphs in textfield</p>
</li>
<li>
<p>[ESPD-93] - Part 1 - title and short description are not exported</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="task"><a class="anchor" href="#task"></a>Task</h4>
<div class="ulist">
<ul>
<li>
<p>[ESPD-91] - Read proof</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="2016-04-02-2nd-of-may-2016"><a class="anchor" href="#2016-04-02-2nd-of-may-2016"></a>2016.04.02 (2nd of May 2016)</h3>
<div class="sect3">
<h4 id="bug-3"><a class="anchor" href="#bug-3"></a>Bug</h4>
<div class="ulist">
<ul>
<li>
<p>[ESPD-93] - Part 1 - title and short description are not exported</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="2016-04-01-25th-of-april-2016"><a class="anchor" href="#2016-04-01-25th-of-april-2016"></a>2016.04.01 (25th of April 2016)</h3>
<div class="sect3">
<h4 id="bug-4"><a class="anchor" href="#bug-4"></a>Bug</h4>
<div class="ulist">
<ul>
<li>
<p>[ESPD-73] - Missing translation</p>
</li>
<li>
<p>[ESPD-78] - Modification of exclusion criterion 'Guilty of misinterpretation'</p>
</li>
<li>
<p>[ESPD-80] - Numbers are handled wrongly</p>
</li>
<li>
<p>[ESPD-81] - Number of years should be calculated automatically</p>
</li>
<li>
<p>[ESPD-83] - EO not able to import a previously created ESPD</p>
</li>
<li>
<p>[ESPD-84] - Textfield into Yes/No</p>
</li>
<li>
<p>[ESPD-85] - Review ESPD as CA goes to non existent page</p>
</li>
<li>
<p>[ESPD-88] - Modification of exclusion ground conflict of interest</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="deploy"><a class="anchor" href="#deploy"></a>Deploy</h4>
<div class="ulist">
<ul>
<li>
<p>[ESPD-56] - Configure GIT</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="improvement-3"><a class="anchor" href="#improvement-3"></a>Improvement</h4>
<div class="ulist">
<ul>
<li>
<p>[ESPD-86] - Printing possibility for CA</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="2016-04-15th-of-april-2016"><a class="anchor" href="#2016-04-15th-of-april-2016"></a>2016.04 (15th of April 2016)</h3>
<div class="sect3">
<h4 id="bug-5"><a class="anchor" href="#bug-5"></a>Bug</h4>
<div class="ulist">
<ul>
<li>
<p>[ESPD-62] - Tooltip bug (Amount concerned box)</p>
</li>
<li>
<p>[ESPD-63] - Results of testing (Editorial Issues)</p>
</li>
<li>
<p>[ESPD-69] - Part 2 &gt; question e) on the Procedure page</p>
</li>
<li>
<p>[ESPD-74] - Tooltip strange symbol</p>
</li>
<li>
<p>[ESPD-75] - Breadcrumb links</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="improvement-4"><a class="anchor" href="#improvement-4"></a>Improvement</h4>
<div class="ulist">
<ul>
<li>
<p>[ESPD-47] - Translation file</p>
</li>
<li>
<p>[ESPD-72] - Exclusion Grounds de-selectable Part C</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="new-feature-2"><a class="anchor" href="#new-feature-2"></a>New Feature</h4>
<div class="ulist">
<ul>
<li>
<p>[ESPD-52] - Statistics</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="1-1-10th-of-february-2016"><a class="anchor" href="#1-1-10th-of-february-2016"></a>1.1 (10th of February 2016)</h3>
<div class="sect3">
<h4 id="test-sub-task"><a class="anchor" href="#test-sub-task"></a>Test Sub-task</h4>
<div class="ulist">
<ul>
<li>
<p>[ESPD-38] - Test of Tests from Application support</p>
</li>
<li>
<p>[ESPD-39] - Test of Tests from Application support</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="bug-6"><a class="anchor" href="#bug-6"></a>Bug</h4>
<div class="ulist">
<ul>
<li>
<p>[ESPD-64] - Results of testing (Translation issues)</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="improvement-5"><a class="anchor" href="#improvement-5"></a>Improvement</h4>
<div class="ulist">
<ul>
<li>
<p>[ESPD-37] - Information from TED to make ESPD easier</p>
</li>
<li>
<p>[ESPD-45] - Improve metadata</p>
</li>
<li>
<p>[ESPD-46] - Merge two ESPD files</p>
</li>
<li>
<p>[ESPD-49] - New EN version</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="task-2"><a class="anchor" href="#task-2"></a>Task</h4>
<div class="ulist">
<ul>
<li>
<p>[ESPD-44] - Test from the application support</p>
</li>
<li>
<p>[ESPD-60] - Upload all translations</p>
</li>
<li>
<p>[ESPD-61] - Leaflet in all languages</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="testing-issue"><a class="anchor" href="#testing-issue"></a>Testing Issue</h4>
<div class="ulist">
<ul>
<li>
<p>[ESPD-55] - Check ESPD service</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="1-0-6th-of-november-2015"><a class="anchor" href="#1-0-6th-of-november-2015"></a>1.0 (6th of November 2015)</h3>
<div class="paragraph">
<p>First version of the application</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="license"><a class="anchor" href="#license"></a>License</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <a href="https://ec.europa.eu/growth/tools-databases/espd/">ESPD</a> project is <a href="https://github.com/ESPD/espd/LICENSE">licensed</a> under the <a href="https://joinup.ec.europa.eu/community/eupl/og_page/eupl">European Union Public Licence</a>.</p>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2016-06-27 16:00:57 CEST
</div>
</div>
</body>
</html>